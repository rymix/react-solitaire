{"version":3,"sources":["../src/components/Card/Card.tsx","../src/components/Pile/Pile.tsx","../src/components/Table/Table.tsx","../src/hooks/useTimer.ts","../src/components/Timer/Timer.tsx","../src/components/Controls/Controls.tsx","../src/themes/win31.ts","../src/hooks/useGame.ts","../src/hooks/useDrag.ts","../src/hooks/useSounds.ts","../src/components/VictoryAnimation/VictoryAnimation.tsx","../src/components/Solitaire/Solitaire.tsx","../src/components/CardBackSelector/CardBackSelector.tsx"],"names":["styled","css","forwardRef","Card","useMemo","getCardColour","SUIT_INFO","RANK_INFO","useCallback","jsx","jsxs","Pile","useRef","useEffect","Table","useState","canAutoComplete","formatScore","createInitialState","GameHistory","cloneState","drawFromStock","resetStock","executeMove","autoMoveToFoundation","autoCompleteStep","flipTableauCard","createWonState","useReducer","React","VictoryAnimation","cardEl","isValidMove","getPile","canPickUpCards","canAutoMove","hasValidMoves"],"mappings":"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","file":"index.cjs","sourcesContent":["import React, { forwardRef, useCallback, useMemo } from 'react';\nimport styled, { css } from 'styled-components';\nimport { SUIT_INFO, RANK_INFO, getCardColour, type Card as CardType } from '@react-solitaire/core';\nimport type { SolitaireTheme } from '../../themes/types';\n\n/**\n * Card component props\n */\nexport interface CardProps {\n  /** The card data */\n  card: CardType;\n  /** Theme for styling */\n  theme: SolitaireTheme;\n  /** Whether the card is selected */\n  isSelected?: boolean;\n  /** Whether the card is being dragged */\n  isDragging?: boolean;\n  /** Whether this is a valid drop target */\n  isValidDrop?: boolean;\n  /** Z-index for stacking */\n  zIndex?: number;\n  /** Click handler */\n  onClick?: (event: React.MouseEvent) => void;\n  /** Double-click handler */\n  onDoubleClick?: (event: React.MouseEvent) => void;\n  /** Pointer down handler (for drag start) */\n  onPointerDown?: (event: React.PointerEvent) => void;\n  /** Additional class name */\n  className?: string;\n  /** Inline style overrides */\n  style?: React.CSSProperties;\n  /** Scale factor for the card */\n  scale?: number;\n}\n\ninterface StyledCardProps {\n  $width: number;\n  $height: number;\n  $borderRadius: number;\n  $borderWidth: number;\n  $shadow: string;\n  $dragShadow: string;\n  $faceUp: boolean;\n  $isSelected: boolean;\n  $isDragging: boolean;\n  $isValidDrop: boolean;\n  $cardBack: string;\n  $cardFace: string;\n  $cardBorder: string;\n  $highlight: string;\n  $validDropColor: string;\n  $scale: number;\n  $flipDuration: number;\n  $useAssets: boolean;\n}\n\nconst StyledCard = styled.div<StyledCardProps>`\n  position: relative;\n  width: ${p => p.$width * p.$scale}px;\n  height: ${p => p.$height * p.$scale}px;\n  border-radius: ${p => p.$borderRadius * p.$scale}px;\n  border: ${p => p.$useAssets ? 'none' : `${p.$borderWidth}px solid ${p.$cardBorder}`};\n  background-color: ${p => p.$useAssets ? 'transparent' : (p.$faceUp ? p.$cardFace : p.$cardBack)};\n  box-shadow: ${p => p.$isDragging ? p.$dragShadow : p.$shadow};\n  cursor: ${p => p.$isDragging ? 'grabbing' : 'grab'};\n  user-select: none;\n  touch-action: none;\n  transition: box-shadow 0.15s ease;\n  overflow: hidden;\n  \n  ${p => p.$isSelected && css`\n    outline: 2px solid ${p.$highlight};\n    outline-offset: 1px;\n  `}\n  \n  ${p => p.$isValidDrop && css`\n    outline: 2px solid ${p.$validDropColor};\n    outline-offset: 1px;\n  `}\n  \n  ${p => p.$isDragging && css`\n    opacity: 0.9;\n    z-index: 1000;\n  `}\n  \n  &:hover {\n    box-shadow: ${p => p.$dragShadow};\n  }\n`;\n\nconst CardImage = styled.img<{ $scale: number }>`\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  /* Pixelated rendering for crisp upscaling */\n  image-rendering: pixelated;\n  image-rendering: -moz-crisp-edges;\n  image-rendering: crisp-edges;\n  pointer-events: none;\n  display: block;\n`;\n\nconst CardFace = styled.div<{ $scale: number }>`\n  position: absolute;\n  inset: 0;\n  display: flex;\n  flex-direction: column;\n  padding: ${p => 3 * p.$scale}px;\n  overflow: hidden;\n`;\n\nconst CornerInfo = styled.div<{ \n  $colour: string; \n  $fontSize: number;\n  $fontFamily: string;\n  $scale: number;\n  $position: 'top-left' | 'bottom-right';\n}>`\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  line-height: 1;\n  color: ${p => p.$colour};\n  font-family: ${p => p.$fontFamily};\n  font-size: ${p => p.$fontSize * p.$scale}px;\n  font-weight: bold;\n  \n  ${p => p.$position === 'top-left' && css`\n    top: ${3 * p.$scale}px;\n    left: ${3 * p.$scale}px;\n  `}\n  \n  ${p => p.$position === 'bottom-right' && css`\n    bottom: ${3 * p.$scale}px;\n    right: ${3 * p.$scale}px;\n    transform: rotate(180deg);\n  `}\n`;\n\nconst CenterSuit = styled.div<{ $colour: string; $fontSize: number; $scale: number }>`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  font-size: ${p => p.$fontSize * 2 * p.$scale}px;\n  color: ${p => p.$colour};\n  opacity: 0.9;\n`;\n\n// Card back pattern component (CSS fallback)\nconst CardBackPattern = styled.div<{ \n  $pattern: string;\n  $primaryColor: string;\n  $secondaryColor?: string;\n  $scale: number;\n}>`\n  position: absolute;\n  inset: ${p => 3 * p.$scale}px;\n  border-radius: ${p => 2 * p.$scale}px;\n  overflow: hidden;\n  \n  ${p => p.$pattern === 'crosshatch' && css`\n    background: \n      repeating-linear-gradient(\n        45deg,\n        ${p.$primaryColor} 0,\n        ${p.$primaryColor} 1px,\n        transparent 1px,\n        transparent 6px\n      ),\n      repeating-linear-gradient(\n        -45deg,\n        ${p.$primaryColor} 0,\n        ${p.$primaryColor} 1px,\n        ${p.$secondaryColor || p.$primaryColor} 1px,\n        ${p.$secondaryColor || p.$primaryColor} 6px\n      );\n  `}\n  \n  ${p => p.$pattern === 'diamonds' && css`\n    background: \n      linear-gradient(135deg, ${p.$primaryColor} 25%, transparent 25%) -10px 0,\n      linear-gradient(225deg, ${p.$primaryColor} 25%, transparent 25%) -10px 0,\n      linear-gradient(315deg, ${p.$primaryColor} 25%, transparent 25%),\n      linear-gradient(45deg, ${p.$primaryColor} 25%, transparent 25%);\n    background-size: 20px 20px;\n    background-color: ${p.$secondaryColor || p.$primaryColor};\n  `}\n`;\n\n/**\n * Get the image filename for a card\n */\nfunction getCardImageFilename(card: CardType): string {\n  // Map suit names to filename prefixes\n  const suitMap: Record<string, string> = {\n    hearts: 'Heart',\n    diamonds: 'Diamond',\n    clubs: 'Club',\n    spades: 'Spade',\n  };\n  \n  const suitPrefix = suitMap[card.suit];\n  return `${suitPrefix}-${card.rank}.gif`;\n}\n\n/**\n * Card component\n */\nexport const Card = forwardRef<HTMLDivElement, CardProps>(function Card(\n  {\n    card,\n    theme,\n    isSelected = false,\n    isDragging = false,\n    isValidDrop = false,\n    zIndex,\n    onClick,\n    onDoubleClick,\n    onPointerDown,\n    className,\n    style,\n    scale = 1,\n  },\n  ref\n) {\n  const colour = useMemo(() => getCardColour(card), [card]);\n  const suitInfo = SUIT_INFO[card.suit];\n  const rankInfo = RANK_INFO[card.rank];\n  \n  const suitColour = colour === 'red' ? theme.colors.redSuit : theme.colors.blackSuit;\n  \n  const useAssets = theme.assets?.enabled ?? false;\n  const basePath = theme.assets?.basePath ?? '/cards';\n  \n  // Get image URLs\n  const cardFaceUrl = useMemo(() => {\n    if (!useAssets) return '';\n    return `${basePath}/${getCardImageFilename(card)}`;\n  }, [useAssets, basePath, card]);\n  \n  const cardBackUrl = useMemo(() => {\n    if (!useAssets) return '';\n    return `${basePath}/${theme.assets?.cardBack ?? 'Back-Pattern1.gif'}`;\n  }, [useAssets, basePath, theme.assets?.cardBack]);\n  \n  const handleClick = useCallback((e: React.MouseEvent) => {\n    e.stopPropagation();\n    onClick?.(e);\n  }, [onClick]);\n  \n  const handleDoubleClick = useCallback((e: React.MouseEvent) => {\n    e.stopPropagation();\n    onDoubleClick?.(e);\n  }, [onDoubleClick]);\n  \n  const handlePointerDown = useCallback((e: React.PointerEvent) => {\n    e.stopPropagation();\n    onPointerDown?.(e);\n  }, [onPointerDown]);\n\n  // Render with image assets\n  if (useAssets) {\n    return (\n      <StyledCard\n        ref={ref}\n        $width={theme.card.width}\n        $height={theme.card.height}\n        $borderRadius={theme.card.borderRadius}\n        $borderWidth={theme.card.borderWidth}\n        $shadow={theme.card.shadow}\n        $dragShadow={theme.card.dragShadow}\n        $faceUp={card.faceUp}\n        $isSelected={isSelected}\n        $isDragging={isDragging}\n        $isValidDrop={isValidDrop}\n        $cardBack={theme.colors.cardBack}\n        $cardFace={theme.colors.cardFace}\n        $cardBorder={theme.colors.cardBorder}\n        $highlight={theme.colors.highlight}\n        $validDropColor={theme.colors.validDrop}\n        $scale={scale}\n        $flipDuration={theme.animation.flip}\n        $useAssets={true}\n        className={className}\n        style={{ ...style, zIndex }}\n        onClick={handleClick}\n        onDoubleClick={handleDoubleClick}\n        onPointerDown={handlePointerDown}\n        data-card-id={card.id}\n      >\n        <CardImage\n          src={card.faceUp ? cardFaceUrl : cardBackUrl}\n          alt={card.faceUp ? `${rankInfo.name} of ${suitInfo.name}` : 'Card back'}\n          $scale={scale}\n          draggable={false}\n        />\n      </StyledCard>\n    );\n  }\n\n  // Render with CSS (fallback)\n  return (\n    <StyledCard\n      ref={ref}\n      $width={theme.card.width}\n      $height={theme.card.height}\n      $borderRadius={theme.card.borderRadius}\n      $borderWidth={theme.card.borderWidth}\n      $shadow={theme.card.shadow}\n      $dragShadow={theme.card.dragShadow}\n      $faceUp={card.faceUp}\n      $isSelected={isSelected}\n      $isDragging={isDragging}\n      $isValidDrop={isValidDrop}\n      $cardBack={theme.colors.cardBack}\n      $cardFace={theme.colors.cardFace}\n      $cardBorder={theme.colors.cardBorder}\n      $highlight={theme.colors.highlight}\n      $validDropColor={theme.colors.validDrop}\n      $scale={scale}\n      $flipDuration={theme.animation.flip}\n      $useAssets={false}\n      className={className}\n      style={{ ...style, zIndex }}\n      onClick={handleClick}\n      onDoubleClick={handleDoubleClick}\n      onPointerDown={handlePointerDown}\n      data-card-id={card.id}\n    >\n      {card.faceUp ? (\n        <CardFace $scale={scale}>\n          <CornerInfo\n            $colour={suitColour}\n            $fontSize={theme.typography.cardFontSize}\n            $fontFamily={theme.typography.cardFont}\n            $scale={scale}\n            $position=\"top-left\"\n          >\n            <span>{rankInfo.symbol}</span>\n            <span>{suitInfo.symbol}</span>\n          </CornerInfo>\n          \n          <CenterSuit\n            $colour={suitColour}\n            $fontSize={theme.typography.cardFontSize}\n            $scale={scale}\n          >\n            {suitInfo.symbol}\n          </CenterSuit>\n          \n          <CornerInfo\n            $colour={suitColour}\n            $fontSize={theme.typography.cardFontSize}\n            $fontFamily={theme.typography.cardFont}\n            $scale={scale}\n            $position=\"bottom-right\"\n          >\n            <span>{rankInfo.symbol}</span>\n            <span>{suitInfo.symbol}</span>\n          </CornerInfo>\n        </CardFace>\n      ) : (\n        <CardBackPattern\n          $pattern={theme.cardBack.pattern || 'crosshatch'}\n          $primaryColor={theme.colors.cardBack}\n          $secondaryColor={theme.colors.cardBackPattern}\n          $scale={scale}\n        />\n      )}\n    </StyledCard>\n  );\n});\n\nCard.displayName = 'Card';\n\nexport default Card;\n","import React, { forwardRef, useCallback, useMemo, useRef, useEffect } from 'react';\nimport styled, { css } from 'styled-components';\nimport { type Pile as PileType, type CardLocation, SUIT_INFO } from '@react-solitaire/core';\nimport type { SolitaireTheme } from '../../themes/types';\nimport { Card } from '../Card';\n\n/**\n * Pile component props\n */\nexport interface PileProps {\n  /** The pile data */\n  pile: PileType;\n  /** Theme for styling */\n  theme: SolitaireTheme;\n  /** Location of this pile */\n  location: Omit<CardLocation, 'cardIndex'>;\n  /** Currently selected card location */\n  selectedCard?: CardLocation | null;\n  /** Current drop target location */\n  dropTarget?: CardLocation | null;\n  /** Whether the pile is a valid drop target */\n  isValidDropTarget?: boolean;\n  /** Click handler for the pile (empty area) */\n  onPileClick?: (location: CardLocation) => void;\n  /** Click handler for a card */\n  onCardClick?: (location: CardLocation) => void;\n  /** Double-click handler for a card */\n  onCardDoubleClick?: (location: CardLocation) => void;\n  /** Pointer down handler for a card (drag start) */\n  onCardPointerDown?: (event: React.PointerEvent, location: CardLocation, element: HTMLElement) => void;\n  /** Register as drop target */\n  registerDropTarget?: (location: CardLocation, element: HTMLElement) => void;\n  /** Unregister as drop target */\n  unregisterDropTarget?: (location: CardLocation) => void;\n  /** Scale factor */\n  scale?: number;\n  /** Additional class name */\n  className?: string;\n  /** Card IDs to hide (for victory animation) */\n  hiddenCardIds?: Set<string>;\n  /** Whether drawing from stock is allowed (for empty stock indicator) */\n  canDrawFromStock?: boolean;\n}\n\ninterface StyledPileProps {\n  $width: number;\n  $height: number;\n  $borderRadius: number;\n  $emptyPileColor: string;\n  $emptyPileBorder: string;\n  $isValidDrop: boolean;\n  $validDropColor: string;\n  $scale: number;\n  $pileType: PileType['type'];\n}\n\nconst StyledPile = styled.div<StyledPileProps>`\n  position: relative;\n  width: ${p => p.$width * p.$scale}px;\n  min-height: ${p => p.$height * p.$scale}px;\n  \n  ${p => p.$pileType !== 'tableau' && css`\n    height: ${p.$height * p.$scale}px;\n  `}\n`;\n\n// Invisible drop zone that covers the entire column for better drop detection\nconst DropZone = styled.div<{ $isValidDrop: boolean; $validDropColor: string }>`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  min-height: 100%;\n  z-index: 0;\n  pointer-events: none;\n  \n  ${p => p.$isValidDrop && css`\n    border: 3px solid ${p.$validDropColor};\n    border-radius: 4px;\n    background-color: ${p.$validDropColor}22;\n    pointer-events: auto;\n  `}\n`;\n\nconst EmptyPileIndicator = styled.div<StyledPileProps>`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: ${p => p.$width * p.$scale}px;\n  height: ${p => p.$height * p.$scale}px;\n  border-radius: ${p => p.$borderRadius * p.$scale}px;\n  background-color: ${p => p.$emptyPileColor};\n  border: 2px dashed ${p => p.$emptyPileBorder};\n  \n  ${p => p.$isValidDrop && css`\n    border-color: ${p.$validDropColor};\n    background-color: ${p.$validDropColor}33;\n  `}\n`;\n\nconst EmptyPileImage = styled.img<{ $scale: number; $isValidDrop: boolean; $validDropColor: string }>`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  /* Pixelated rendering for crisp upscaling */\n  image-rendering: pixelated;\n  image-rendering: -moz-crisp-edges;\n  image-rendering: crisp-edges;\n  pointer-events: none;\n  \n  ${p => p.$isValidDrop && css`\n    outline: 2px solid ${p.$validDropColor};\n    outline-offset: -2px;\n  `}\n`;\n\nconst FoundationSuit = styled.div<{ $colour: string; $fontSize: number; $scale: number }>`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  font-size: ${p => p.$fontSize * 2.5 * p.$scale}px;\n  color: ${p => p.$colour};\n  opacity: 0.4;\n  pointer-events: none;\n`;\n\nconst StockIndicator = styled.div<{ $fontSize: number; $textColor: string; $scale: number }>`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  font-size: ${p => p.$fontSize * p.$scale}px;\n  color: ${p => p.$textColor};\n  opacity: 0.6;\n  pointer-events: none;\n`;\n\ninterface CardWrapperProps {\n  $top: number;\n  $left: number;\n  $zIndex: number;\n}\n\nconst CardWrapper = styled.div<CardWrapperProps>`\n  position: absolute;\n  top: ${p => p.$top}px;\n  left: ${p => p.$left}px;\n  z-index: ${p => p.$zIndex};\n`;\n\n/**\n * Get the foundation suit indicator for empty foundations\n */\nfunction getFoundationSuitIndicator(pileIndex: number): { symbol: string; colour: 'red' | 'black' } {\n  const suits = ['hearts', 'diamonds', 'clubs', 'spades'] as const;\n  const suit = suits[pileIndex];\n  return {\n    symbol: SUIT_INFO[suit].symbol,\n    colour: SUIT_INFO[suit].colour,\n  };\n}\n\n/**\n * Pile component\n */\nexport const Pile = forwardRef<HTMLDivElement, PileProps>(function Pile(\n  {\n    pile,\n    theme,\n    location,\n    selectedCard,\n    dropTarget,\n    isValidDropTarget = false,\n    onPileClick,\n    onCardClick,\n    onCardDoubleClick,\n    onCardPointerDown,\n    registerDropTarget,\n    unregisterDropTarget,\n    scale = 1,\n    className,\n    hiddenCardIds,\n    canDrawFromStock = true,\n  },\n  ref\n) {\n  const pileRef = useRef<HTMLDivElement>(null);\n  const dropZoneRef = useRef<HTMLDivElement>(null);\n  const cardRefs = useRef<Map<number, HTMLDivElement>>(new Map());\n\n  const useAssets = theme.assets?.enabled ?? false;\n  const basePath = theme.assets?.basePath ?? '/cards';\n\n  // Register pile as drop target - use the full pile container\n  useEffect(() => {\n    // Use pileRef for the main container (for non-tableau) or dropZoneRef for tableau\n    const targetElement = pile.type === 'tableau' ? dropZoneRef.current : pileRef.current;\n    if (!targetElement) return;\n    \n    // Don't register stock or waste as drop targets\n    if (pile.type === 'stock' || pile.type === 'waste') return;\n    \n    const dropLocation: CardLocation = {\n      ...location,\n      cardIndex: pile.cards.length,\n    };\n    \n    registerDropTarget?.(dropLocation, targetElement);\n    \n    return () => {\n      unregisterDropTarget?.(dropLocation);\n    };\n  }, [location, pile.cards.length, pile.type, registerDropTarget, unregisterDropTarget]);\n\n  // Calculate card positions\n  const cardPositions = useMemo(() => {\n    return pile.cards.map((_, index) => {\n      let top = 0;\n      let left = 0;\n\n      if (pile.type === 'tableau') {\n        // Stack vertically with offset based on face up/down\n        for (let i = 0; i < index; i++) {\n          const prevCard = pile.cards[i];\n          if (prevCard.faceUp) {\n            top += theme.spacing.tableauStackedVisible * scale;\n          } else {\n            top += theme.spacing.tableauStackedHidden * scale;\n          }\n        }\n      } else if (pile.type === 'waste') {\n        // Show last 3 cards with horizontal offset\n        const visibleCount = Math.min(3, pile.cards.length);\n        const startIndex = pile.cards.length - visibleCount;\n        if (index >= startIndex) {\n          left = (index - startIndex) * theme.spacing.wasteOffset * scale;\n        }\n      }\n      // Foundation and stock don't stack visually\n\n      return { top, left, visible: pile.type !== 'waste' || index >= pile.cards.length - 3 };\n    });\n  }, [pile.cards, pile.type, theme.spacing, scale]);\n\n  const handlePileClick = useCallback(() => {\n    const cardLocation: CardLocation = {\n      ...location,\n      cardIndex: pile.cards.length, // Point to where next card would go\n    };\n    onPileClick?.(cardLocation);\n  }, [location, pile.cards.length, onPileClick]);\n\n  const handleCardClick = useCallback((cardIndex: number) => {\n    const cardLocation: CardLocation = { ...location, cardIndex };\n    onCardClick?.(cardLocation);\n  }, [location, onCardClick]);\n\n  const handleCardDoubleClick = useCallback((cardIndex: number) => {\n    const cardLocation: CardLocation = { ...location, cardIndex };\n    onCardDoubleClick?.(cardLocation);\n  }, [location, onCardDoubleClick]);\n\n  const handleCardPointerDown = useCallback((event: React.PointerEvent, cardIndex: number) => {\n    const element = cardRefs.current.get(cardIndex);\n    if (!element) return;\n    \n    const cardLocation: CardLocation = { ...location, cardIndex };\n    onCardPointerDown?.(event, cardLocation, element);\n  }, [location, onCardPointerDown]);\n\n  const isCardSelected = useCallback((cardIndex: number) => {\n    if (!selectedCard) return false;\n    return (\n      selectedCard.pileType === location.pileType &&\n      selectedCard.pileIndex === location.pileIndex &&\n      selectedCard.cardIndex === cardIndex\n    );\n  }, [selectedCard, location]);\n\n  const isDropTargetCard = useCallback((cardIndex: number) => {\n    if (!dropTarget || !isValidDropTarget) return false;\n    return (\n      dropTarget.pileType === location.pileType &&\n      dropTarget.pileIndex === location.pileIndex &&\n      cardIndex === pile.cards.length - 1 // Only highlight top card\n    );\n  }, [dropTarget, isValidDropTarget, location, pile.cards.length]);\n\n  // Determine if the empty pile should show as drop target\n  const showEmptyAsDropTarget = isValidDropTarget && pile.cards.length === 0 && dropTarget && \n    dropTarget.pileType === location.pileType && \n    dropTarget.pileIndex === location.pileIndex;\n\n  // Determine if the entire pile should show as a valid drop target (for tableau with cards)\n  const showPileAsDropTarget = isValidDropTarget && pile.cards.length > 0 && dropTarget &&\n    dropTarget.pileType === location.pileType &&\n    dropTarget.pileIndex === location.pileIndex &&\n    (pile.type === 'tableau' || pile.type === 'foundation');\n\n  return (\n    <StyledPile\n      ref={ref}\n      $width={theme.card.width}\n      $height={theme.card.height}\n      $borderRadius={theme.card.borderRadius}\n      $emptyPileColor={theme.colors.emptyPile}\n      $emptyPileBorder={theme.colors.emptyPileBorder}\n      $isValidDrop={Boolean(showEmptyAsDropTarget)}\n      $validDropColor={theme.colors.validDrop}\n      $scale={scale}\n      $pileType={pile.type}\n      className={className}\n    >\n      {/* Drop zone for tableau - covers entire column for better drop detection */}\n      {pile.type === 'tableau' && (\n        <DropZone\n          ref={dropZoneRef}\n          $isValidDrop={Boolean(showPileAsDropTarget || showEmptyAsDropTarget)}\n          $validDropColor={theme.colors.validDrop}\n        />\n      )}\n\n      {/* Drop target for foundations - always present for drop detection */}\n      {useAssets && pile.type === 'foundation' && (\n        <div\n          ref={pileRef}\n          onClick={handlePileClick}\n          style={{ \n            position: 'absolute', \n            top: 0, \n            left: 0, \n            width: theme.card.width * scale, \n            height: theme.card.height * scale,\n            zIndex: 0,\n          }}\n        >\n          {/* Only show empty indicator image when no cards */}\n          {pile.cards.length === 0 && (\n            <EmptyPileImage\n              src={`${basePath}/${theme.assets?.foundationEmpty ?? 'Space-Vacant.gif'}`}\n              alt=\"Empty foundation\"\n              $scale={scale}\n              $isValidDrop={Boolean(showEmptyAsDropTarget)}\n              $validDropColor={theme.colors.validDrop}\n            />\n          )}\n        </div>\n      )}\n\n      {/* Empty pile indicator - Image-based (stock and tableau only) */}\n      {useAssets && pile.cards.length === 0 && pile.type !== 'foundation' && (\n        <div\n          ref={pile.type === 'stock' ? pileRef : undefined}\n          onClick={handlePileClick}\n          style={{ \n            position: 'absolute', \n            top: 0, \n            left: 0, \n            width: theme.card.width * scale, \n            height: theme.card.height * scale,\n            cursor: pile.type === 'stock' ? 'pointer' : 'default',\n          }}\n        >\n          {/* Stock empty indicator */}\n          {pile.type === 'stock' && (\n            <EmptyPileImage\n              src={`${basePath}/${canDrawFromStock ? theme.assets?.stockEmpty ?? 'Space-Yes.gif' : theme.assets?.stockDisabled ?? 'Space-No.gif'}`}\n              alt={canDrawFromStock ? 'Click to recycle' : 'No more draws'}\n              $scale={scale}\n              $isValidDrop={false}\n              $validDropColor={theme.colors.validDrop}\n            />\n          )}\n          \n          {/* Tableau empty - just use vacant space */}\n          {pile.type === 'tableau' && (\n            <EmptyPileImage\n              src={`${basePath}/${theme.assets?.foundationEmpty ?? 'Space-Vacant.gif'}`}\n              alt=\"Empty column\"\n              $scale={scale}\n              $isValidDrop={Boolean(showEmptyAsDropTarget)}\n              $validDropColor={theme.colors.validDrop}\n            />\n          )}\n        </div>\n      )}\n\n      {/* Empty pile indicator - CSS fallback */}\n      {!useAssets && (\n        <EmptyPileIndicator\n          ref={pileRef}\n          $width={theme.card.width}\n          $height={theme.card.height}\n          $borderRadius={theme.card.borderRadius}\n          $emptyPileColor={theme.colors.emptyPile}\n          $emptyPileBorder={theme.colors.emptyPileBorder}\n          $isValidDrop={Boolean(showEmptyAsDropTarget)}\n          $validDropColor={theme.colors.validDrop}\n          $scale={scale}\n          $pileType={pile.type}\n          onClick={handlePileClick}\n        >\n          {/* Foundation suit indicator */}\n          {pile.type === 'foundation' && pile.cards.length === 0 && (\n            <FoundationSuit\n              $colour={\n                getFoundationSuitIndicator(location.pileIndex).colour === 'red'\n                  ? theme.colors.redSuit\n                  : theme.colors.blackSuit\n              }\n              $fontSize={theme.typography.cardFontSize}\n              $scale={scale}\n            >\n              {getFoundationSuitIndicator(location.pileIndex).symbol}\n            </FoundationSuit>\n          )}\n          \n          {/* Stock recycle indicator */}\n          {pile.type === 'stock' && pile.cards.length === 0 && (\n            <StockIndicator\n              $fontSize={theme.typography.uiFontSize}\n              $textColor={theme.colors.textSecondary}\n              $scale={scale}\n            >\n              \n            </StockIndicator>\n          )}\n        </EmptyPileIndicator>\n      )}\n\n      {/* Cards */}\n      {pile.cards.map((card, index) => {\n        const position = cardPositions[index];\n        if (!position.visible) return null;\n        \n        // Hide cards that are being animated (victory animation)\n        if (hiddenCardIds?.has(card.id)) return null;\n\n        return (\n          <CardWrapper\n            key={card.id}\n            ref={el => {\n              if (el) cardRefs.current.set(index, el);\n              else cardRefs.current.delete(index);\n            }}\n            $top={position.top}\n            $left={position.left}\n            $zIndex={index + 1}\n          >\n            <Card\n              card={card}\n              theme={theme}\n              isSelected={isCardSelected(index)}\n              isValidDrop={isDropTargetCard(index)}\n              scale={scale}\n              onClick={() => handleCardClick(index)}\n              onDoubleClick={() => handleCardDoubleClick(index)}\n              onPointerDown={(e) => handleCardPointerDown(e, index)}\n            />\n          </CardWrapper>\n        );\n      })}\n    </StyledPile>\n  );\n});\n\nPile.displayName = 'Pile';\n\nexport default Pile;\n","import React, { forwardRef } from 'react';\nimport styled from 'styled-components';\nimport type { GameState, CardLocation } from '@react-solitaire/core';\nimport type { SolitaireTheme } from '../../themes/types';\nimport { Pile } from '../Pile';\n\n/**\n * Table component props\n */\nexport interface TableProps {\n  /** Current game state */\n  gameState: GameState;\n  /** Theme for styling */\n  theme: SolitaireTheme;\n  /** Currently selected card location */\n  selectedCard?: CardLocation | null;\n  /** Current drop target location */\n  dropTarget?: CardLocation | null;\n  /** Check if a location is a valid drop target */\n  isValidDropTarget?: (location: CardLocation) => boolean;\n  /** Click handler for stock pile */\n  onStockClick?: () => void;\n  /** Click handler for a card */\n  onCardClick?: (location: CardLocation) => void;\n  /** Double-click handler for a card */\n  onCardDoubleClick?: (location: CardLocation) => void;\n  /** Pointer down handler for drag start */\n  onCardPointerDown?: (event: React.PointerEvent, location: CardLocation, element: HTMLElement) => void;\n  /** Register drop target */\n  registerDropTarget?: (location: CardLocation, element: HTMLElement) => void;\n  /** Unregister drop target */\n  unregisterDropTarget?: (location: CardLocation) => void;\n  /** Scale factor */\n  scale?: number;\n  /** Additional class name */\n  className?: string;\n  /** Card IDs to hide (for victory animation) */\n  hiddenCardIds?: Set<string>;\n  /** Whether more draws from stock are allowed */\n  canDrawFromStock?: boolean;\n}\n\ninterface StyledTableProps {\n  $tableColor: string;\n  $padding: number;\n  $pileGap: number;\n  $scale: number;\n}\n\nconst StyledTable = styled.div<StyledTableProps>`\n  display: flex;\n  flex-direction: column;\n  gap: ${p => p.$pileGap * p.$scale * 1.5}px;\n  padding: ${p => p.$padding * p.$scale}px;\n  background-color: ${p => p.$tableColor};\n  min-height: 100%;\n  box-sizing: border-box;\n`;\n\nconst TopRow = styled.div<{ $gap: number; $scale: number }>`\n  display: flex;\n  gap: ${p => p.$gap * p.$scale}px;\n  justify-content: space-between;\n`;\n\nconst StockWasteArea = styled.div<{ $gap: number; $scale: number }>`\n  display: flex;\n  gap: ${p => p.$gap * p.$scale}px;\n`;\n\nconst FoundationsArea = styled.div<{ $gap: number; $scale: number }>`\n  display: flex;\n  gap: ${p => p.$gap * p.$scale}px;\n`;\n\nconst TableauRow = styled.div<{ $gap: number; $scale: number }>`\n  display: flex;\n  gap: ${p => p.$gap * p.$scale}px;\n  justify-content: flex-start;\n  flex: 1;\n`;\n\n/**\n * Table component - arranges all piles in the classic Solitaire layout\n */\nexport const Table = forwardRef<HTMLDivElement, TableProps>(function Table(\n  {\n    gameState,\n    theme,\n    selectedCard,\n    dropTarget,\n    isValidDropTarget,\n    onStockClick,\n    onCardClick,\n    onCardDoubleClick,\n    onCardPointerDown,\n    registerDropTarget,\n    unregisterDropTarget,\n    scale = 1,\n    className,\n    hiddenCardIds,\n    canDrawFromStock = true,\n  },\n  ref\n) {\n  const checkValidDrop = (location: CardLocation) => {\n    return isValidDropTarget?.(location) ?? false;\n  };\n\n  return (\n    <StyledTable\n      ref={ref}\n      $tableColor={theme.colors.table}\n      $padding={theme.spacing.tablePadding}\n      $pileGap={theme.spacing.pileGap}\n      $scale={scale}\n      className={className}\n    >\n      {/* Top row: Stock, Waste, and Foundations */}\n      <TopRow $gap={theme.spacing.pileGap} $scale={scale}>\n        <StockWasteArea $gap={theme.spacing.pileGap} $scale={scale}>\n          {/* Stock pile */}\n          <Pile\n            pile={gameState.stock}\n            theme={theme}\n            location={{ pileType: 'stock', pileIndex: 0 }}\n            selectedCard={selectedCard}\n            dropTarget={dropTarget}\n            scale={scale}\n            onPileClick={onStockClick ? () => onStockClick() : undefined}\n            onCardClick={onStockClick ? () => onStockClick() : undefined}\n            canDrawFromStock={canDrawFromStock}\n          />\n          \n          {/* Waste pile */}\n          <Pile\n            pile={gameState.waste}\n            theme={theme}\n            location={{ pileType: 'waste', pileIndex: 0 }}\n            selectedCard={selectedCard}\n            dropTarget={dropTarget}\n            scale={scale}\n            onCardClick={onCardClick}\n            onCardDoubleClick={onCardDoubleClick}\n            onCardPointerDown={onCardPointerDown}\n            registerDropTarget={registerDropTarget}\n            unregisterDropTarget={unregisterDropTarget}\n          />\n        </StockWasteArea>\n\n        {/* Foundations */}\n        <FoundationsArea $gap={theme.spacing.pileGap} $scale={scale}>\n          {gameState.foundations.map((foundation, index) => (\n            <Pile\n              key={foundation.id}\n              pile={foundation}\n              theme={theme}\n              location={{ pileType: 'foundation', pileIndex: index }}\n              selectedCard={selectedCard}\n              dropTarget={dropTarget}\n              isValidDropTarget={checkValidDrop({ pileType: 'foundation', pileIndex: index, cardIndex: foundation.cards.length })}\n              scale={scale}\n              onCardClick={onCardClick}\n              onCardDoubleClick={onCardDoubleClick}\n              onCardPointerDown={onCardPointerDown}\n              registerDropTarget={registerDropTarget}\n              unregisterDropTarget={unregisterDropTarget}\n              hiddenCardIds={hiddenCardIds}\n            />\n          ))}\n        </FoundationsArea>\n      </TopRow>\n\n      {/* Tableau row */}\n      <TableauRow $gap={theme.spacing.pileGap} $scale={scale}>\n        {gameState.tableau.map((tableau, index) => (\n          <Pile\n            key={tableau.id}\n            pile={tableau}\n            theme={theme}\n            location={{ pileType: 'tableau', pileIndex: index }}\n            selectedCard={selectedCard}\n            dropTarget={dropTarget}\n            isValidDropTarget={checkValidDrop({ pileType: 'tableau', pileIndex: index, cardIndex: tableau.cards.length })}\n            scale={scale}\n            onCardClick={onCardClick}\n            onCardDoubleClick={onCardDoubleClick}\n            onCardPointerDown={onCardPointerDown}\n            registerDropTarget={registerDropTarget}\n            unregisterDropTarget={unregisterDropTarget}\n          />\n        ))}\n      </TableauRow>\n    </StyledTable>\n  );\n});\n\nTable.displayName = 'Table';\n\nexport default Table;\n","import { useState, useEffect, useCallback, useRef } from 'react';\n\n/**\n * Timer state\n */\nexport interface TimerState {\n  /** Elapsed seconds */\n  seconds: number;\n  /** Whether the timer is running */\n  isRunning: boolean;\n  /** Formatted time string (MM:SS) */\n  formatted: string;\n}\n\n/**\n * Hook options\n */\nexport interface UseTimerOptions {\n  /** Start time (timestamp) */\n  startTime: number | null;\n  /** End time (timestamp, if game is complete) */\n  endTime: number | null;\n  /** Update interval in ms */\n  interval?: number;\n}\n\n/**\n * Format seconds as MM:SS\n */\nfunction formatTime(seconds: number): string {\n  const mins = Math.floor(seconds / 60);\n  const secs = seconds % 60;\n  return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n}\n\n/**\n * Hook for managing and displaying elapsed game time\n */\nexport function useTimer(options: UseTimerOptions): TimerState {\n  const { startTime, endTime, interval = 1000 } = options;\n  \n  const [seconds, setSeconds] = useState(0);\n  const intervalRef = useRef<ReturnType<typeof setInterval> | null>(null);\n\n  const calculateSeconds = useCallback(() => {\n    if (!startTime) return 0;\n    const end = endTime ?? Date.now();\n    return Math.floor((end - startTime) / 1000);\n  }, [startTime, endTime]);\n\n  // Update on mount and when dependencies change\n  useEffect(() => {\n    setSeconds(calculateSeconds());\n  }, [calculateSeconds]);\n\n  // Set up interval for live updates\n  useEffect(() => {\n    // Clear any existing interval\n    if (intervalRef.current) {\n      clearInterval(intervalRef.current);\n      intervalRef.current = null;\n    }\n\n    // Only run interval if game is in progress (has start time, no end time)\n    if (startTime && !endTime) {\n      intervalRef.current = setInterval(() => {\n        setSeconds(calculateSeconds());\n      }, interval);\n    }\n\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [startTime, endTime, interval, calculateSeconds]);\n\n  const isRunning = Boolean(startTime && !endTime);\n  const formatted = formatTime(seconds);\n\n  return {\n    seconds,\n    isRunning,\n    formatted,\n  };\n}\n\n/**\n * Simple stopwatch hook for standalone timing\n */\nexport function useStopwatch() {\n  const [startTime, setStartTime] = useState<number | null>(null);\n  const [endTime, setEndTime] = useState<number | null>(null);\n\n  const timer = useTimer({ startTime, endTime });\n\n  const start = useCallback(() => {\n    setStartTime(Date.now());\n    setEndTime(null);\n  }, []);\n\n  const stop = useCallback(() => {\n    if (startTime && !endTime) {\n      setEndTime(Date.now());\n    }\n  }, [startTime, endTime]);\n\n  const reset = useCallback(() => {\n    setStartTime(null);\n    setEndTime(null);\n  }, []);\n\n  const restart = useCallback(() => {\n    setStartTime(Date.now());\n    setEndTime(null);\n  }, []);\n\n  return {\n    ...timer,\n    start,\n    stop,\n    reset,\n    restart,\n  };\n}\n","import styled from 'styled-components';\nimport type { SolitaireTheme } from '../../themes/types';\nimport { useTimer } from '../../hooks/useTimer';\n\n/**\n * Timer component props\n */\nexport interface TimerProps {\n  /** Game start timestamp */\n  startTime: number | null;\n  /** Game end timestamp */\n  endTime: number | null;\n  /** Theme for styling */\n  theme: SolitaireTheme;\n  /** Additional class name */\n  className?: string;\n}\n\ninterface StyledTimerProps {\n  $fontFamily: string;\n  $fontSize: number;\n  $textColor: string;\n}\n\nconst StyledTimer = styled.div<StyledTimerProps>`\n  font-family: ${p => p.$fontFamily};\n  font-size: ${p => p.$fontSize}px;\n  color: ${p => p.$textColor};\n  font-variant-numeric: tabular-nums;\n  min-width: 4em;\n  text-align: center;\n`;\n\nconst Label = styled.span`\n  opacity: 0.7;\n  margin-right: 0.5em;\n`;\n\n/**\n * Timer display component\n */\nexport function Timer({ startTime, endTime, theme, className }: TimerProps) {\n  const { formatted } = useTimer({ startTime, endTime });\n\n  return (\n    <StyledTimer\n      $fontFamily={theme.typography.uiFont}\n      $fontSize={theme.typography.uiFontSize}\n      $textColor={theme.colors.text}\n      className={className}\n    >\n      <Label>Time:</Label>\n      {formatted}\n    </StyledTimer>\n  );\n}\n\nexport default Timer;\n","import styled from 'styled-components';\nimport type { SolitaireTheme } from '../../themes/types';\nimport { formatScore, type ScoringMode } from '@react-solitaire/core';\n\n/**\n * Controls component props\n */\nexport interface ControlsProps {\n  /** Current score */\n  score: number;\n  /** Number of moves */\n  moves: number;\n  /** Scoring mode */\n  scoringMode: ScoringMode;\n  /** Whether undo is available */\n  canUndo: boolean;\n  /** Whether auto-complete is available */\n  canAutoComplete: boolean;\n  /** Theme for styling */\n  theme: SolitaireTheme;\n  /** New game handler */\n  onNewGame: () => void;\n  /** Undo handler */\n  onUndo: () => void;\n  /** Auto-complete handler */\n  onAutoComplete: () => void;\n  /** Additional class name */\n  className?: string;\n}\n\ninterface StyledControlsProps {\n  $fontFamily: string;\n  $fontSize: number;\n  $textColor: string;\n  $secondaryColor: string;\n}\n\nconst StyledControls = styled.div<StyledControlsProps>`\n  display: flex;\n  align-items: center;\n  gap: 1.5rem;\n  font-family: ${p => p.$fontFamily};\n  font-size: ${p => p.$fontSize}px;\n  color: ${p => p.$textColor};\n`;\n\nconst Stat = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 0.4em;\n`;\n\nconst StatLabel = styled.span<{ $color: string }>`\n  color: ${p => p.$color};\n  opacity: 0.7;\n`;\n\nconst StatValue = styled.span`\n  font-variant-numeric: tabular-nums;\n  min-width: 3em;\n`;\n\nconst Button = styled.button<{ $fontFamily: string; $fontSize: number; $disabled?: boolean }>`\n  font-family: ${p => p.$fontFamily};\n  font-size: ${p => p.$fontSize}px;\n  padding: 0.4em 0.8em;\n  border: 1px solid currentColor;\n  border-radius: 3px;\n  background: transparent;\n  color: inherit;\n  cursor: ${p => p.$disabled ? 'not-allowed' : 'pointer'};\n  opacity: ${p => p.$disabled ? 0.5 : 1};\n  transition: background-color 0.15s ease;\n  \n  &:hover:not(:disabled) {\n    background: rgba(255, 255, 255, 0.1);\n  }\n  \n  &:active:not(:disabled) {\n    background: rgba(255, 255, 255, 0.2);\n  }\n`;\n\nconst ButtonGroup = styled.div`\n  display: flex;\n  gap: 0.5rem;\n  margin-left: auto;\n`;\n\n/**\n * Game controls and stats display\n */\nexport function Controls({\n  score,\n  moves,\n  scoringMode,\n  canUndo,\n  canAutoComplete,\n  theme,\n  onNewGame,\n  onUndo,\n  onAutoComplete,\n  className,\n}: ControlsProps) {\n  const formattedScore = formatScore(score, scoringMode);\n\n  return (\n    <StyledControls\n      $fontFamily={theme.typography.uiFont}\n      $fontSize={theme.typography.uiFontSize}\n      $textColor={theme.colors.text}\n      $secondaryColor={theme.colors.textSecondary}\n      className={className}\n    >\n      {scoringMode !== 'none' && (\n        <Stat>\n          <StatLabel $color={theme.colors.textSecondary}>Score:</StatLabel>\n          <StatValue>{formattedScore}</StatValue>\n        </Stat>\n      )}\n      \n      <Stat>\n        <StatLabel $color={theme.colors.textSecondary}>Moves:</StatLabel>\n        <StatValue>{moves}</StatValue>\n      </Stat>\n\n      <ButtonGroup>\n        <Button\n          $fontFamily={theme.typography.uiFont}\n          $fontSize={theme.typography.uiFontSize}\n          onClick={onUndo}\n          disabled={!canUndo}\n          $disabled={!canUndo}\n          title=\"Undo (Ctrl+Z)\"\n        >\n          Undo\n        </Button>\n        \n        {canAutoComplete && (\n          <Button\n            $fontFamily={theme.typography.uiFont}\n            $fontSize={theme.typography.uiFontSize}\n            onClick={onAutoComplete}\n            title=\"Auto-complete remaining cards\"\n          >\n            Auto\n          </Button>\n        )}\n        \n        <Button\n          $fontFamily={theme.typography.uiFont}\n          $fontSize={theme.typography.uiFontSize}\n          onClick={onNewGame}\n          title=\"Start a new game (F2)\"\n        >\n          New Game\n        </Button>\n      </ButtonGroup>\n    </StyledControls>\n  );\n}\n\nexport default Controls;\n","import type { SolitaireTheme } from './types';\n\n/**\n * Windows 3.1 Solitaire theme\n * Faithful recreation of the classic look and feel\n */\nexport const win31Theme: SolitaireTheme = {\n  name: 'Windows 3.1',\n\n  colors: {\n    // The classic green felt\n    table: '#008000',\n    // Cream/white card face\n    cardFace: '#FFFFFF',\n    // Classic blue card back\n    cardBack: '#0000AA',\n    cardBackPattern: '#000080',\n    // Suit colours\n    redSuit: '#FF0000',\n    blackSuit: '#000000',\n    // Card styling\n    cardBorder: '#000000',\n    // Empty pile styling (darker green with dashed outline)\n    emptyPile: 'rgba(0, 64, 0, 0.5)',\n    emptyPileBorder: 'rgba(0, 100, 0, 0.8)',\n    // Highlights\n    highlight: 'rgba(255, 255, 0, 0.3)',\n    validDrop: 'rgba(0, 255, 0, 0.3)',\n    // Text\n    text: '#FFFFFF',\n    textSecondary: '#C0C0C0',\n  },\n\n  card: {\n    // Windows 3.1 used 71x96 pixel cards\n    // We'll scale up for modern displays\n    width: 71,\n    height: 96,\n    borderRadius: 3,\n    borderWidth: 1,\n    shadow: '1px 1px 2px rgba(0, 0, 0, 0.3)',\n    dragShadow: '4px 4px 8px rgba(0, 0, 0, 0.4)',\n  },\n\n  spacing: {\n    // Tight stacking for hidden cards\n    tableauStackedHidden: 4,\n    // More visible stacking for face-up cards\n    tableauStackedVisible: 18,\n    // Offset for draw-three waste display\n    wasteOffset: 14,\n    // Gap between piles\n    pileGap: 12,\n    // Table padding\n    tablePadding: 16,\n  },\n\n  animation: {\n    flip: 150,\n    move: 200,\n    victoryDelay: 50,\n    victoryBounce: 400,\n  },\n\n  typography: {\n    // Classic Windows font\n    cardFont: '\"MS Sans Serif\", \"Segoe UI\", Arial, sans-serif',\n    cardFontSize: 14,\n    uiFont: '\"MS Sans Serif\", \"Segoe UI\", Arial, sans-serif',\n    uiFontSize: 12,\n  },\n\n  cardBack: {\n    type: 'pattern',\n    pattern: 'crosshatch',\n  },\n};\n\nexport { win31Theme as defaultTheme };\n","import { useReducer, useCallback, useMemo, useRef } from 'react';\nimport {\n  createInitialState,\n  createWonState,\n  drawFromStock,\n  resetStock,\n  executeMove,\n  flipTableauCard,\n  autoMoveToFoundation,\n  autoCompleteStep,\n  cloneState,\n  GameHistory,\n  type GameState,\n  type GameConfig,\n  type CardLocation,\n  type MoveResult,\n} from '@react-solitaire/core';\n\n/**\n * Actions for the game reducer\n */\ntype GameAction =\n  | { type: 'NEW_GAME'; config?: Partial<GameConfig>; seed?: number }\n  | { type: 'DRAW' }\n  | { type: 'RESET_STOCK' }\n  | { type: 'MOVE'; from: CardLocation; to: CardLocation; cardCount: number }\n  | { type: 'AUTO_MOVE'; from: CardLocation }\n  | { type: 'AUTO_COMPLETE_STEP' }\n  | { type: 'FLIP_CARD'; tableauIndex: number }\n  | { type: 'UNDO' }\n  | { type: 'SET_STATE'; state: GameState }\n  | { type: 'TRIGGER_WIN'; config?: Partial<GameConfig> };\n\n/**\n * Game reducer state wrapper\n */\ninterface GameReducerState {\n  game: GameState;\n  history: GameHistory;\n  lastMoveResult: MoveResult | null;\n}\n\n/**\n * Reducer for game state management\n */\nfunction gameReducer(state: GameReducerState, action: GameAction): GameReducerState {\n  switch (action.type) {\n    case 'NEW_GAME': {\n      const newGame = createInitialState(action.config, action.seed);\n      const history = new GameHistory();\n      return { game: newGame, history, lastMoveResult: null };\n    }\n\n    case 'DRAW': {\n      if (state.game.stock.cards.length === 0) {\n        return state;\n      }\n      const previousState = cloneState(state.game);\n      const newGame = drawFromStock(state.game);\n      \n      state.history.push({\n        move: {\n          from: { pileType: 'stock', pileIndex: 0, cardIndex: state.game.stock.cards.length - 1 },\n          to: { pileType: 'waste', pileIndex: 0, cardIndex: state.game.waste.cards.length },\n          cardCount: state.game.config.drawMode === 'draw-three' ? 3 : 1,\n          flippedCard: false,\n          scoreChange: 0,\n        },\n        previousState,\n      });\n      \n      return { ...state, game: newGame, lastMoveResult: { success: true, state: newGame } };\n    }\n\n    case 'RESET_STOCK': {\n      if (state.game.waste.cards.length === 0) {\n        return state;\n      }\n      const previousState = cloneState(state.game);\n      const newGame = resetStock(state.game);\n      \n      state.history.push({\n        move: {\n          from: { pileType: 'waste', pileIndex: 0, cardIndex: 0 },\n          to: { pileType: 'stock', pileIndex: 0, cardIndex: 0 },\n          cardCount: state.game.waste.cards.length,\n          flippedCard: false,\n          scoreChange: 0,\n        },\n        previousState,\n      });\n      \n      return { ...state, game: newGame, lastMoveResult: { success: true, state: newGame } };\n    }\n\n    case 'MOVE': {\n      const previousState = cloneState(state.game);\n      const result = executeMove(state.game, action.from, action.to, action.cardCount);\n      \n      if (result.success && result.state && result.move) {\n        state.history.push({\n          move: result.move,\n          previousState,\n        });\n        return { ...state, game: result.state, lastMoveResult: result };\n      }\n      \n      return { ...state, lastMoveResult: result };\n    }\n\n    case 'AUTO_MOVE': {\n      const previousState = cloneState(state.game);\n      const result = autoMoveToFoundation(state.game, action.from);\n      \n      if (result.success && result.state && result.move) {\n        state.history.push({\n          move: result.move,\n          previousState,\n        });\n        return { ...state, game: result.state, lastMoveResult: result };\n      }\n      \n      return { ...state, lastMoveResult: result };\n    }\n\n    case 'AUTO_COMPLETE_STEP': {\n      const newGame = autoCompleteStep(state.game);\n      \n      if (newGame) {\n        // Don't record individual auto-complete moves in history\n        return { ...state, game: newGame, lastMoveResult: { success: true, state: newGame } };\n      }\n      \n      return state;\n    }\n\n    case 'FLIP_CARD': {\n      const previousState = cloneState(state.game);\n      const result = flipTableauCard(state.game, action.tableauIndex);\n      \n      if (result.success && result.state) {\n        state.history.push({\n          move: {\n            from: { pileType: 'tableau', pileIndex: action.tableauIndex, cardIndex: state.game.tableau[action.tableauIndex].cards.length - 1 },\n            to: { pileType: 'tableau', pileIndex: action.tableauIndex, cardIndex: state.game.tableau[action.tableauIndex].cards.length - 1 },\n            cardCount: 0,\n            flippedCard: true,\n            scoreChange: 5, // Standard score for revealing a card\n          },\n          previousState,\n        });\n        return { ...state, game: result.state, lastMoveResult: result };\n      }\n      \n      return { ...state, lastMoveResult: result };\n    }\n\n    case 'UNDO': {\n      const previousState = state.history.undo();\n      if (previousState) {\n        return { ...state, game: previousState, lastMoveResult: null };\n      }\n      return state;\n    }\n\n    case 'SET_STATE': {\n      return { ...state, game: action.state, lastMoveResult: null };\n    }\n\n    case 'TRIGGER_WIN': {\n      const wonState = createWonState(action.config);\n      const history = new GameHistory();\n      return { game: wonState, history, lastMoveResult: null };\n    }\n\n    default:\n      return state;\n  }\n}\n\n/**\n * Hook options\n */\nexport interface UseGameOptions {\n  /** Initial game configuration */\n  config?: Partial<GameConfig>;\n  /** Seed for reproducible games */\n  seed?: number;\n  /** Callback when game is won */\n  onWin?: (state: GameState) => void;\n  /** Callback on any move */\n  onMove?: (result: MoveResult) => void;\n}\n\n/**\n * Hook return type\n */\nexport interface UseGameReturn {\n  /** Current game state */\n  state: GameState;\n  /** Start a new game */\n  newGame: (config?: Partial<GameConfig>, seed?: number) => void;\n  /** Draw from stock */\n  draw: () => void;\n  /** Reset waste to stock */\n  resetWaste: () => void;\n  /** Move cards between piles */\n  move: (from: CardLocation, to: CardLocation, cardCount: number) => MoveResult;\n  /** Auto-move card to foundation (double-click) */\n  autoMove: (from: CardLocation) => MoveResult;\n  /** Flip a face-down tableau card */\n  flipCard: (tableauIndex: number) => void;\n  /** Perform one auto-complete step */\n  autoCompleteStep: () => boolean;\n  /** Undo last move */\n  undo: () => void;\n  /** Whether undo is available */\n  canUndo: boolean;\n  /** Last move result */\n  lastMoveResult: MoveResult | null;\n  /** Elapsed time in seconds */\n  elapsedTime: number;\n  /** Trigger win state for testing */\n  triggerWin: () => void;\n}\n\n/**\n * Hook for managing solitaire game state\n */\nexport function useGame(options: UseGameOptions = {}): UseGameReturn {\n  const { config, seed } = options;\n\n  // Use refs to avoid recreating callbacks when config changes\n  const configRef = useRef(config);\n  const seedRef = useRef(seed);\n  configRef.current = config;\n  seedRef.current = seed;\n\n  const [reducerState, dispatch] = useReducer(gameReducer, null, () => ({\n    game: createInitialState(config, seed),\n    history: new GameHistory(),\n    lastMoveResult: null,\n  }));\n\n  const { game, history, lastMoveResult } = reducerState;\n\n  // Stable callbacks that don't change\n  const newGame = useCallback((newConfig?: Partial<GameConfig>, newSeed?: number) => {\n    dispatch({ type: 'NEW_GAME', config: newConfig ?? configRef.current, seed: newSeed ?? seedRef.current });\n  }, []);\n\n  const draw = useCallback(() => {\n    dispatch({ type: 'DRAW' });\n  }, []);\n\n  const resetWaste = useCallback(() => {\n    dispatch({ type: 'RESET_STOCK' });\n  }, []);\n\n  const move = useCallback((from: CardLocation, to: CardLocation, cardCount: number): MoveResult => {\n    dispatch({ type: 'MOVE', from, to, cardCount });\n    // Note: This returns the previous result, not the one from this action\n    // The caller should check the state after render if needed\n    return { success: true, error: undefined };\n  }, []);\n\n  const autoMove = useCallback((from: CardLocation): MoveResult => {\n    dispatch({ type: 'AUTO_MOVE', from });\n    return { success: true, error: undefined };\n  }, []);\n\n  const flipCard = useCallback((tableauIndex: number): void => {\n    dispatch({ type: 'FLIP_CARD', tableauIndex });\n  }, []);\n\n  const autoCompleteStepFn = useCallback((): boolean => {\n    dispatch({ type: 'AUTO_COMPLETE_STEP' });\n    return true; // Caller should check gameState.isWon\n  }, []);\n\n  const undo = useCallback(() => {\n    dispatch({ type: 'UNDO' });\n  }, []);\n\n  const triggerWin = useCallback(() => {\n    dispatch({ type: 'TRIGGER_WIN', config: configRef.current });\n  }, []);\n\n  const canUndo = history.canUndo();\n\n  const elapsedTime = useMemo(() => {\n    if (!game.startTime) return 0;\n    const endTime = game.endTime ?? Date.now();\n    return Math.floor((endTime - game.startTime) / 1000);\n  }, [game.startTime, game.endTime]);\n\n  return {\n    state: game,\n    newGame,\n    draw,\n    resetWaste,\n    move,\n    autoMove,\n    flipCard,\n    autoCompleteStep: autoCompleteStepFn,\n    undo,\n    canUndo,\n    lastMoveResult,\n    elapsedTime,\n    triggerWin,\n  };\n}\n","import { useState, useCallback, useRef, useEffect } from 'react';\nimport type { CardLocation } from '@react-solitaire/core';\n\n/**\n * Drag state information\n */\nexport interface DragState {\n  /** Whether a drag is in progress */\n  isDragging: boolean;\n  /** Source location of the drag */\n  source: CardLocation | null;\n  /** Number of cards being dragged */\n  cardCount: number;\n  /** Current X position relative to viewport */\n  currentX: number;\n  /** Current Y position relative to viewport */\n  currentY: number;\n  /** Starting X position */\n  startX: number;\n  /** Starting Y position */\n  startY: number;\n  /** Offset from card top-left to pointer */\n  offsetX: number;\n  /** Offset from card top-left to pointer */\n  offsetY: number;\n}\n\n/**\n * Drop target information\n */\nexport interface DropTarget {\n  /** Location of the drop target */\n  location: CardLocation;\n  /** Whether the drop is valid */\n  isValid: boolean;\n  /** Bounding rect of the target element */\n  rect: DOMRect;\n}\n\n/**\n * Hook options\n */\nexport interface UseDragOptions {\n  /** Callback when drag starts */\n  onDragStart?: (source: CardLocation, cardCount: number) => void;\n  /** Callback during drag */\n  onDragMove?: (x: number, y: number) => void;\n  /** Callback when drag ends (with or without drop) */\n  onDragEnd?: (source: CardLocation, target: CardLocation | null, cardCount: number) => void;\n  /** Callback when dropped on a valid target */\n  onDrop?: (source: CardLocation, target: CardLocation, cardCount: number) => void;\n  /** Function to check if a drop target is valid */\n  isValidDrop?: (source: CardLocation, target: CardLocation, cardCount: number) => boolean;\n  /** Minimum distance before drag starts (prevents accidental drags) */\n  dragThreshold?: number;\n}\n\n/**\n * Hook return type\n */\nexport interface UseDragReturn {\n  /** Current drag state */\n  dragState: DragState;\n  /** Start a drag operation */\n  startDrag: (\n    event: React.PointerEvent,\n    source: CardLocation,\n    cardCount: number,\n    cardElement: HTMLElement\n  ) => void;\n  /** Cancel the current drag */\n  cancelDrag: () => void;\n  /** Register a drop target */\n  registerDropTarget: (location: CardLocation, element: HTMLElement) => void;\n  /** Unregister a drop target */\n  unregisterDropTarget: (location: CardLocation) => void;\n  /** Current drop target (if hovering over one) */\n  currentDropTarget: DropTarget | null;\n}\n\nconst initialDragState: DragState = {\n  isDragging: false,\n  source: null,\n  cardCount: 0,\n  currentX: 0,\n  currentY: 0,\n  startX: 0,\n  startY: 0,\n  offsetX: 0,\n  offsetY: 0,\n};\n\n/**\n * Hook for managing drag and drop with unified mouse/touch support\n */\nexport function useDrag(options: UseDragOptions = {}): UseDragReturn {\n  const { dragThreshold = 5 } = options;\n\n  // Store all callbacks in a ref to avoid recreating handlers\n  const optionsRef = useRef(options);\n  optionsRef.current = options;\n\n  const [dragState, setDragState] = useState<DragState>(initialDragState);\n  const [currentDropTarget, setCurrentDropTarget] = useState<DropTarget | null>(null);\n  \n  const dropTargetsRef = useRef<Map<string, { location: CardLocation; element: HTMLElement }>>(\n    new Map()\n  );\n  const dragStartedRef = useRef(false);\n  const pendingDragRef = useRef<{\n    source: CardLocation;\n    cardCount: number;\n    startX: number;\n    startY: number;\n    offsetX: number;\n    offsetY: number;\n    element: HTMLElement;\n    pointerId: number;\n  } | null>(null);\n\n  /**\n   * Create a unique key for a card location\n   */\n  const locationKey = (loc: CardLocation): string => {\n    return `${loc.pileType}-${loc.pileIndex}-${loc.cardIndex}`;\n  };\n\n  /**\n   * Find drop target at a given position\n   * Uses padding to make drop detection more forgiving\n   */\n  const findDropTarget = useCallback((\n    x: number, \n    y: number, \n    source: CardLocation, \n    cardCount: number\n  ): DropTarget | null => {\n    const PADDING = 15; // Extra pixels of tolerance around drop zones\n    \n    for (const { location, element } of dropTargetsRef.current.values()) {\n      const rect = element.getBoundingClientRect();\n      // Add padding to make drops easier\n      const paddedRect = {\n        left: rect.left - PADDING,\n        right: rect.right + PADDING,\n        top: rect.top - PADDING,\n        bottom: rect.bottom + PADDING,\n      };\n      \n      if (x >= paddedRect.left && x <= paddedRect.right && \n          y >= paddedRect.top && y <= paddedRect.bottom) {\n        const isValid = optionsRef.current.isValidDrop?.(source, location, cardCount) ?? true;\n        return { location, isValid, rect };\n      }\n    }\n    return null;\n  }, []);\n\n  /**\n   * Handle pointer move during drag\n   */\n  const handlePointerMove = useCallback((event: PointerEvent) => {\n    const pending = pendingDragRef.current;\n    if (!pending) return;\n\n    const x = event.clientX;\n    const y = event.clientY;\n\n    // Check if we should start the actual drag (passed threshold)\n    if (!dragStartedRef.current) {\n      const dx = x - pending.startX;\n      const dy = y - pending.startY;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n\n      if (distance >= dragThreshold) {\n        dragStartedRef.current = true;\n        \n        // Now capture the pointer for drag tracking\n        try {\n          pending.element.setPointerCapture(pending.pointerId);\n        } catch {\n          // Pointer capture may fail if pointer was released\n        }\n        \n        setDragState({\n          isDragging: true,\n          source: pending.source,\n          cardCount: pending.cardCount,\n          currentX: x,\n          currentY: y,\n          startX: pending.startX,\n          startY: pending.startY,\n          offsetX: pending.offsetX,\n          offsetY: pending.offsetY,\n        });\n\n        optionsRef.current.onDragStart?.(pending.source, pending.cardCount);\n      }\n      return;\n    }\n\n    // Update position during drag\n    setDragState(prev => ({\n      ...prev,\n      currentX: x,\n      currentY: y,\n    }));\n\n    optionsRef.current.onDragMove?.(x, y);\n\n    // Find drop target\n    const target = findDropTarget(x, y, pending.source, pending.cardCount);\n    setCurrentDropTarget(target);\n  }, [dragThreshold, findDropTarget]);\n\n  /**\n   * Handle pointer up (end drag)\n   */\n  const handlePointerUp = useCallback((event: PointerEvent) => {\n    const pending = pendingDragRef.current;\n    if (!pending) return;\n\n    if (dragStartedRef.current) {\n      const x = event.clientX;\n      const y = event.clientY;\n      const target = findDropTarget(x, y, pending.source, pending.cardCount);\n\n      if (target && target.isValid) {\n        optionsRef.current.onDrop?.(pending.source, target.location, pending.cardCount);\n      }\n\n      optionsRef.current.onDragEnd?.(pending.source, target?.location ?? null, pending.cardCount);\n    }\n\n    setDragState(initialDragState);\n    setCurrentDropTarget(null);\n    dragStartedRef.current = false;\n    pendingDragRef.current = null;\n  }, [findDropTarget]);\n\n  /**\n   * Handle pointer cancel (e.g., touch interrupted)\n   */\n  const handlePointerCancel = useCallback(() => {\n    const pending = pendingDragRef.current;\n    \n    if (dragStartedRef.current && pending) {\n      optionsRef.current.onDragEnd?.(pending.source, null, pending.cardCount);\n    }\n\n    setDragState(initialDragState);\n    setCurrentDropTarget(null);\n    dragStartedRef.current = false;\n    pendingDragRef.current = null;\n  }, []);\n\n  /**\n   * Start a drag operation\n   */\n  const startDrag = useCallback((\n    event: React.PointerEvent,\n    source: CardLocation,\n    cardCount: number,\n    cardElement: HTMLElement\n  ) => {\n    const rect = cardElement.getBoundingClientRect();\n    const offsetX = event.clientX - rect.left;\n    const offsetY = event.clientY - rect.top;\n\n    // Store pending drag info (won't start until threshold is met)\n    // Don't capture pointer yet - let click/double-click events work\n    pendingDragRef.current = {\n      source,\n      cardCount,\n      startX: event.clientX,\n      startY: event.clientY,\n      offsetX,\n      offsetY,\n      element: cardElement,\n      pointerId: event.pointerId,\n    };\n  }, []);\n\n  /**\n   * Cancel the current drag\n   */\n  const cancelDrag = useCallback(() => {\n    handlePointerCancel();\n  }, [handlePointerCancel]);\n\n  /**\n   * Register a drop target\n   */\n  const registerDropTarget = useCallback((location: CardLocation, element: HTMLElement) => {\n    dropTargetsRef.current.set(locationKey(location), { location, element });\n  }, []);\n\n  /**\n   * Unregister a drop target\n   */\n  const unregisterDropTarget = useCallback((location: CardLocation) => {\n    dropTargetsRef.current.delete(locationKey(location));\n  }, []);\n\n  // Set up global event listeners - stable handlers due to refs\n  useEffect(() => {\n    window.addEventListener('pointermove', handlePointerMove);\n    window.addEventListener('pointerup', handlePointerUp);\n    window.addEventListener('pointercancel', handlePointerCancel);\n\n    return () => {\n      window.removeEventListener('pointermove', handlePointerMove);\n      window.removeEventListener('pointerup', handlePointerUp);\n      window.removeEventListener('pointercancel', handlePointerCancel);\n    };\n  }, [handlePointerMove, handlePointerUp, handlePointerCancel]);\n\n  return {\n    dragState,\n    startDrag,\n    cancelDrag,\n    registerDropTarget,\n    unregisterDropTarget,\n    currentDropTarget,\n  };\n}\n","import { useCallback, useMemo } from 'react';\nimport type { SoundConfig } from '../themes/types';\n\n/**\n * Sound effect types\n */\nexport type SoundEffect = \n  | 'flip'\n  | 'place'\n  | 'pickup'\n  | 'draw'\n  | 'invalid'\n  | 'victory'\n  | 'bounce';\n\n/**\n * Hook return type\n */\nexport interface UseSoundsReturn {\n  /** Play a sound effect */\n  play: (effect: SoundEffect, options?: { playbackRate?: number }) => void;\n  /** Stop a sound effect */\n  stop: (effect: SoundEffect) => void;\n  /** Whether sounds are enabled */\n  enabled: boolean;\n  /** Set enabled state */\n  setEnabled: (enabled: boolean) => void;\n  /** Current volume */\n  volume: number;\n  /** Set volume */\n  setVolume: (volume: number) => void;\n}\n\n/**\n * Default sound configuration\n */\nexport const defaultSoundConfig: SoundConfig = {\n  enabled: true,\n  volume: 0.5,\n  sounds: {},\n};\n\n/**\n * Hook for managing game sound effects\n * \n * This is a simplified version that works without use-sound.\n * When use-sound is available, it will use that for better\n * audio handling.\n */\nexport function useSounds(config: Partial<SoundConfig> = {}): UseSoundsReturn {\n  const mergedConfig = useMemo(() => ({\n    ...defaultSoundConfig,\n    ...config,\n    sounds: { ...defaultSoundConfig.sounds, ...config.sounds },\n  }), [config]);\n\n  // For now, we'll use the Web Audio API directly\n  // This can be replaced with use-sound integration later\n  const audioContext = useMemo(() => {\n    if (typeof window !== 'undefined' && window.AudioContext) {\n      return new AudioContext();\n    }\n    return null;\n  }, []);\n\n  const play = useCallback((effect: SoundEffect, options: { playbackRate?: number } = {}) => {\n    if (!mergedConfig.enabled || !audioContext) return;\n\n    const soundUrl = mergedConfig.sounds[effect];\n    if (!soundUrl) {\n      // Generate a simple beep for missing sounds (development)\n      const oscillator = audioContext.createOscillator();\n      const gainNode = audioContext.createGain();\n      \n      oscillator.connect(gainNode);\n      gainNode.connect(audioContext.destination);\n      \n      // Different frequencies for different effects\n      const frequencies: Record<SoundEffect, number> = {\n        flip: 800,\n        place: 600,\n        pickup: 700,\n        draw: 500,\n        invalid: 200,\n        victory: 1000,\n        bounce: 400,\n      };\n      \n      oscillator.frequency.value = frequencies[effect];\n      oscillator.type = 'sine';\n      \n      gainNode.gain.value = mergedConfig.volume * 0.3;\n      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);\n      \n      oscillator.start(audioContext.currentTime);\n      oscillator.stop(audioContext.currentTime + 0.1);\n      \n      return;\n    }\n\n    // Load and play the actual sound\n    fetch(soundUrl)\n      .then(response => response.arrayBuffer())\n      .then(buffer => audioContext.decodeAudioData(buffer))\n      .then(audioBuffer => {\n        const source = audioContext.createBufferSource();\n        const gainNode = audioContext.createGain();\n        \n        source.buffer = audioBuffer;\n        source.playbackRate.value = options.playbackRate ?? 1;\n        \n        source.connect(gainNode);\n        gainNode.connect(audioContext.destination);\n        gainNode.gain.value = mergedConfig.volume;\n        \n        source.start(0);\n      })\n      .catch(err => {\n        console.warn(`Failed to play sound: ${effect}`, err);\n      });\n  }, [audioContext, mergedConfig]);\n\n  const stop = useCallback((_effect: SoundEffect) => {\n    // For Web Audio API, sounds are short enough that stopping isn't needed\n    // With use-sound, this would call the stop function\n  }, []);\n\n  const setEnabled = useCallback((_enabled: boolean) => {\n    // This would update state in a real implementation\n    // For now, config is controlled by parent\n  }, []);\n\n  const setVolume = useCallback((_volume: number) => {\n    // This would update state in a real implementation\n    // For now, config is controlled by parent\n  }, []);\n\n  return {\n    play,\n    stop,\n    enabled: mergedConfig.enabled,\n    setEnabled,\n    volume: mergedConfig.volume,\n    setVolume,\n  };\n}\n\n/**\n * Create a sound sprite configuration for use-sound\n * This bundles all sounds into a single file with markers\n */\nexport function createSoundSprite(_sounds: SoundConfig['sounds']): Record<string, [number, number]> {\n  // This would be used to create sprite markers for a combined sound file\n  // For now, return empty object\n  return {};\n}\n","import React, { useEffect, useRef, useMemo, useState } from 'react';\nimport styled from 'styled-components';\nimport { type Card as CardType, type GameState } from '@react-solitaire/core';\nimport type { SolitaireTheme } from '../../themes/types';\nimport { Card } from '../Card';\n\n/**\n * VictoryAnimation component props\n */\nexport interface VictoryAnimationProps {\n  /** Game state (to get foundation cards) */\n  gameState: GameState;\n  /** Theme for styling */\n  theme: SolitaireTheme;\n  /** Container dimensions */\n  containerWidth: number;\n  containerHeight: number;\n  /** Callback when animation completes */\n  onComplete?: () => void;\n  /** Scale factor */\n  scale?: number;\n  /** Play bounce sound (throttled internally) */\n  onBounce?: () => void;\n  /** Callback with IDs of cards that have been launched (to hide from foundations) */\n  onCardsLaunched?: (cardIds: Set<string>) => void;\n}\n\n/**\n * Physics state for a bouncing card (kept in ref, not React state)\n */\ninterface CardPhysics {\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n  rotation: number;\n  rotationSpeed: number;\n  launched: boolean;\n  launchTime: number;\n  opacity: number;\n  trailPositions: Array<{ x: number; y: number; rotation: number; opacity: number }>;\n}\n\nconst AnimationContainer = styled.div`\n  position: absolute;\n  inset: 0;\n  overflow: hidden;\n  pointer-events: none;\n  z-index: 1000;\n`;\n\nconst CardSlot = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n  will-change: transform, opacity;\n  visibility: hidden;\n`;\n\nconst TrailSlot = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n  will-change: transform, opacity;\n  visibility: hidden;\n`;\n\n// Physics constants\nconst GRAVITY = 0.4;\nconst BOUNCE_DAMPING = 0.75;\nconst HORIZONTAL_SPEED_MIN = 3;\nconst HORIZONTAL_SPEED_MAX = 6;\nconst INITIAL_VERTICAL_SPEED = -12;\nconst TRAIL_LENGTH = 6;\nconst TRAIL_FADE_RATE = 0.15;\nconst CARD_LAUNCH_DELAY = 120;\nconst ROTATION_SPEED_MAX = 8;\nconst CARD_LIFETIME = 5000; // 5 seconds before card is removed\nconst FADE_START_TIME = 3000; // Start fading at 3 seconds\nconst FADE_DURATION = 2000; // Fade over 2 seconds\nconst BOUNCE_SOUND_THROTTLE = 100; // Minimum ms between bounce sounds\n\n/**\n * VictoryAnimation component - optimised for smooth 60fps animation\n * Pre-renders all cards once, then uses pure DOM manipulation for physics\n */\nexport const VictoryAnimation = React.memo(function VictoryAnimation({\n  gameState,\n  theme,\n  containerWidth,\n  containerHeight,\n  onComplete,\n  scale = 1,\n  onBounce,\n  onCardsLaunched,\n}: VictoryAnimationProps) {\n  // State to track if animation is active (for cleanup)\n  const [isActive, setIsActive] = useState(true);\n  \n  // Refs for DOM elements\n  const cardSlotsRef = useRef<Map<number, HTMLDivElement>>(new Map());\n  const trailSlotsRef = useRef<Map<string, HTMLDivElement>>(new Map());\n  \n  // Refs for animation state\n  const physicsRef = useRef<CardPhysics[]>([]);\n  const animationRef = useRef<number | null>(null);\n  const launchIndexRef = useRef(0);\n  const lastLaunchTimeRef = useRef(0);\n  const completedRef = useRef(false);\n  const launchedIdsRef = useRef<Set<string>>(new Set());\n  const animationStartTimeRef = useRef(0);\n  const lastBounceTimeRef = useRef(0);\n  \n  // Stable refs for callbacks\n  const onCompleteRef = useRef(onComplete);\n  const onCardsLaunchedRef = useRef(onCardsLaunched);\n  const onBounceRef = useRef(onBounce);\n  onCompleteRef.current = onComplete;\n  onCardsLaunchedRef.current = onCardsLaunched;\n  onBounceRef.current = onBounce;\n\n  const cardWidth = theme.card.width * scale;\n  const cardHeight = theme.card.height * scale;\n  const pileGap = theme.spacing.pileGap * scale;\n  const padding = theme.spacing.tablePadding * scale;\n\n  // Pre-compute all cards to animate (only recalculate when foundations change)\n  const cardsToAnimate = useMemo(() => {\n    const cards: Array<{ card: CardType; foundationIndex: number; uniqueKey: string }> = [];\n    // Interleave from King down to Ace across all foundations\n    for (let rank = 12; rank >= 0; rank--) {\n      for (let foundationIndex = 0; foundationIndex < 4; foundationIndex++) {\n        const foundation = gameState.foundations[foundationIndex];\n        if (foundation.cards[rank]) {\n          const card = foundation.cards[rank];\n          cards.push({ \n            card, \n            foundationIndex,\n            uniqueKey: `victory-${card.id}-${foundationIndex}-${rank}`,\n          });\n        }\n      }\n    }\n    return cards;\n  }, [gameState.foundations]);\n\n  // Calculate foundation start position\n  const getFoundationX = (foundationIndex: number) => {\n    const foundationsWidth = (cardWidth * 4) + (pileGap * 3);\n    const rightEdge = containerWidth - padding;\n    const foundationsStartX = rightEdge - foundationsWidth;\n    return foundationsStartX + (foundationIndex * (cardWidth + pileGap));\n  };\n\n  // Initialise physics state and start animation\n  useEffect(() => {\n    if (!isActive) return;\n    \n    // Reset state\n    launchIndexRef.current = 0;\n    lastLaunchTimeRef.current = 0;\n    completedRef.current = false;\n    launchedIdsRef.current = new Set();\n    animationStartTimeRef.current = performance.now();\n    \n    // Initialise physics for each card\n    physicsRef.current = cardsToAnimate.map(({ foundationIndex }) => ({\n      x: getFoundationX(foundationIndex),\n      y: padding,\n      vx: 0,\n      vy: 0,\n      rotation: 0,\n      rotationSpeed: 0,\n      launched: false,\n      launchTime: 0,\n      opacity: 1,\n      trailPositions: [],\n    }));\n\n    // Hide all slots initially\n    cardSlotsRef.current.forEach(el => {\n      el.style.visibility = 'hidden';\n    });\n    trailSlotsRef.current.forEach(el => {\n      el.style.visibility = 'hidden';\n    });\n\n    let lastTime = performance.now();\n\n    const animate = (currentTime: number) => {\n      const deltaTime = Math.min((currentTime - lastTime) / 16.67, 2);\n      lastTime = currentTime;\n\n      // Launch cards periodically\n      if (launchIndexRef.current < cardsToAnimate.length) {\n        if (currentTime - lastLaunchTimeRef.current > CARD_LAUNCH_DELAY) {\n          const idx = launchIndexRef.current;\n          const { card, foundationIndex } = cardsToAnimate[idx];\n          const physics = physicsRef.current[idx];\n          \n          // Initialise physics for launch\n          const goLeft = Math.random() > 0.5;\n          const hSpeed = HORIZONTAL_SPEED_MIN + Math.random() * (HORIZONTAL_SPEED_MAX - HORIZONTAL_SPEED_MIN);\n          \n          physics.x = getFoundationX(foundationIndex);\n          physics.y = padding;\n          physics.vx = goLeft ? -hSpeed : hSpeed;\n          physics.vy = INITIAL_VERTICAL_SPEED;\n          physics.rotation = 0;\n          physics.rotationSpeed = (Math.random() - 0.5) * ROTATION_SPEED_MAX;\n          physics.launched = true;\n          physics.launchTime = currentTime;\n          physics.opacity = 1;\n          physics.trailPositions = [];\n\n          // Show the card slot\n          const cardEl = cardSlotsRef.current.get(idx);\n          if (cardEl) {\n            cardEl.style.visibility = 'visible';\n            cardEl.style.opacity = '1';\n            cardEl.style.transform = `translate(${physics.x}px, ${physics.y}px) rotate(0deg)`;\n          }\n\n          // Track launched card IDs\n          launchedIdsRef.current.add(card.id);\n          onCardsLaunchedRef.current?.(new Set(launchedIdsRef.current));\n\n          launchIndexRef.current++;\n          lastLaunchTimeRef.current = currentTime;\n        }\n      }\n\n      // Update physics for all launched cards\n      let activeCount = 0;\n      \n      for (let i = 0; i < physicsRef.current.length; i++) {\n        const physics = physicsRef.current[i];\n        if (!physics.launched) continue;\n\n        const cardAge = currentTime - physics.launchTime;\n        \n        // Remove card after lifetime expires\n        if (cardAge > CARD_LIFETIME) {\n          physics.launched = false;\n          const cardEl = cardSlotsRef.current.get(i);\n          if (cardEl) cardEl.style.visibility = 'hidden';\n          for (let t = 0; t < TRAIL_LENGTH; t++) {\n            const trailEl = trailSlotsRef.current.get(`${i}-${t}`);\n            if (trailEl) trailEl.style.visibility = 'hidden';\n          }\n          continue;\n        }\n\n        activeCount++;\n\n        // Calculate fade based on age\n        if (cardAge > FADE_START_TIME) {\n          physics.opacity = 1 - ((cardAge - FADE_START_TIME) / FADE_DURATION);\n          physics.opacity = Math.max(0, Math.min(1, physics.opacity));\n        }\n\n        // Update trail\n        physics.trailPositions = [\n          { x: physics.x, y: physics.y, rotation: physics.rotation, opacity: physics.opacity },\n          ...physics.trailPositions.slice(0, TRAIL_LENGTH - 1).map(t => ({\n            ...t,\n            opacity: t.opacity * (1 - TRAIL_FADE_RATE),\n          })),\n        ].filter(t => t.opacity > 0.01);\n\n        // Apply physics\n        physics.vy += GRAVITY * deltaTime;\n        physics.y += physics.vy * deltaTime;\n        physics.x += physics.vx * deltaTime;\n        physics.rotation += physics.rotationSpeed * deltaTime;\n\n        // Bounce off bottom\n        if (physics.y + cardHeight > containerHeight) {\n          physics.y = containerHeight - cardHeight;\n          physics.vy = -physics.vy * BOUNCE_DAMPING;\n          \n          // Play bounce sound (throttled)\n          if (currentTime - lastBounceTimeRef.current > BOUNCE_SOUND_THROTTLE) {\n            lastBounceTimeRef.current = currentTime;\n            onBounceRef.current?.();\n          }\n        }\n\n        // Bounce off sides\n        if (physics.x < 0) {\n          physics.x = 0;\n          physics.vx = -physics.vx * BOUNCE_DAMPING;\n        } else if (physics.x + cardWidth > containerWidth) {\n          physics.x = containerWidth - cardWidth;\n          physics.vx = -physics.vx * BOUNCE_DAMPING;\n        }\n\n        // Update DOM directly\n        const cardEl = cardSlotsRef.current.get(i);\n        if (cardEl) {\n          cardEl.style.transform = `translate(${physics.x}px, ${physics.y}px) rotate(${physics.rotation}deg)`;\n          cardEl.style.opacity = String(physics.opacity);\n        }\n\n        // Update trails\n        for (let t = 0; t < TRAIL_LENGTH; t++) {\n          const trailEl = trailSlotsRef.current.get(`${i}-${t}`);\n          if (trailEl) {\n            const trail = physics.trailPositions[t];\n            if (trail && trail.opacity > 0.01) {\n              trailEl.style.visibility = 'visible';\n              trailEl.style.transform = `translate(${trail.x}px, ${trail.y}px) rotate(${trail.rotation}deg)`;\n              trailEl.style.opacity = String(trail.opacity * 0.5);\n            } else {\n              trailEl.style.visibility = 'hidden';\n            }\n          }\n        }\n      }\n\n      // Check completion - all cards launched and all have expired\n      const allLaunched = launchIndexRef.current >= cardsToAnimate.length;\n      if (allLaunched && activeCount === 0 && !completedRef.current && cardsToAnimate.length > 0) {\n        completedRef.current = true;\n        setIsActive(false);\n        setTimeout(() => onCompleteRef.current?.(), 100);\n        return; // Stop animation loop\n      }\n\n      animationRef.current = requestAnimationFrame(animate);\n    };\n\n    animationRef.current = requestAnimationFrame(animate);\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current);\n      }\n    };\n  }, [cardsToAnimate, containerWidth, containerHeight, cardWidth, cardHeight, padding, pileGap, isActive]);\n\n  // Register card slot ref\n  const setCardSlotRef = (index: number) => (el: HTMLDivElement | null) => {\n    if (el) cardSlotsRef.current.set(index, el);\n  };\n\n  // Register trail slot ref\n  const setTrailSlotRef = (cardIndex: number, trailIndex: number) => (el: HTMLDivElement | null) => {\n    if (el) trailSlotsRef.current.set(`${cardIndex}-${trailIndex}`, el);\n  };\n\n  if (!isActive && completedRef.current) {\n    return null; // Remove from DOM after completion\n  }\n\n  return (\n    <AnimationContainer>\n      {/* Pre-render all card slots with their trails */}\n      {cardsToAnimate.map(({ card, uniqueKey }, cardIndex) => (\n        <React.Fragment key={uniqueKey}>\n          {/* Trail slots for this card */}\n          {Array.from({ length: TRAIL_LENGTH }, (_, trailIndex) => (\n            <TrailSlot\n              key={`${uniqueKey}-trail-${trailIndex}`}\n              ref={setTrailSlotRef(cardIndex, trailIndex)}\n            >\n              <Card card={card} theme={theme} scale={scale} />\n            </TrailSlot>\n          ))}\n          {/* Main card slot */}\n          <CardSlot key={`${uniqueKey}-main`} ref={setCardSlotRef(cardIndex)}>\n            <Card card={card} theme={theme} scale={scale} />\n          </CardSlot>\n        </React.Fragment>\n      ))}\n    </AnimationContainer>\n  );\n});\n\nexport default VictoryAnimation;\n","import React, { useCallback, useState, useRef, useEffect, useMemo } from 'react';\nimport styled from 'styled-components';\nimport {\n  type CardLocation,\n  type GameConfig,\n  isValidMove,\n  canPickUpCards,\n  getPile,\n  canAutoComplete,\n  canAutoMove,\n  hasValidMoves,\n} from '@react-solitaire/core';\nimport type { SolitaireTheme, SolitaireOptions } from '../../themes/types';\nimport { defaultTheme } from '../../themes';\nimport { useGame } from '../../hooks/useGame';\nimport { useDrag } from '../../hooks/useDrag';\nimport { useTimer } from '../../hooks/useTimer';\nimport { useSounds } from '../../hooks/useSounds';\nimport { Table } from '../Table';\nimport { Card } from '../Card';\nimport { VictoryAnimation } from '../VictoryAnimation';\n\n/**\n * Solitaire component props\n */\nexport interface SolitaireProps {\n  /** Theme for styling */\n  theme?: SolitaireTheme;\n  /** Game options */\n  options?: SolitaireOptions;\n  /** Callback when game is won */\n  onWin?: (stats: { time: number; moves: number; score: number }) => void;\n  /** Callback when a new game starts */\n  onNewGame?: () => void;\n  /** External control: start new game */\n  newGameTrigger?: number;\n  /** Scale factor (1 = original size) */\n  scale?: number;\n  /** Additional class name */\n  className?: string;\n  /** Show test win button (for debugging) */\n  showTestButton?: boolean;\n}\n\nconst SolitaireContainer = styled.div<{ $width: number; $height: number }>`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  min-width: ${p => p.$width}px;\n  min-height: ${p => p.$height}px;\n  overflow: auto;\n`;\n\nconst DragLayer = styled.div`\n  position: fixed;\n  pointer-events: none;\n  z-index: 10000;\n  left: 0;\n  top: 0;\n`;\n\nconst DraggedCardsContainer = styled.div.attrs<{ $x: number; $y: number }>(props => ({\n  style: {\n    transform: `translate(${props.$x}px, ${props.$y}px)`,\n  },\n}))<{ $x: number; $y: number }>`\n  position: absolute;\n  left: 0;\n  top: 0;\n`;\n\nconst StatusBar = styled.div<{ $font: string; $fontSize: number; $color: string; $bgColor: string }>`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  justify-content: space-between;\n  padding: 8px 16px;\n  font-family: ${p => p.$font};\n  font-size: ${p => p.$fontSize}px;\n  color: ${p => p.$color};\n  background-color: ${p => p.$bgColor};\n`;\n\nconst AutoCompleteButton = styled.button<{ $font: string; $visible: boolean }>`\n  position: absolute;\n  bottom: 40px;\n  left: 50%;\n  transform: translateX(-50%);\n  padding: 8px 24px;\n  font-family: ${p => p.$font};\n  font-size: 14px;\n  background: #c0c0c0;\n  border: 2px outset #ffffff;\n  cursor: pointer;\n  opacity: ${p => p.$visible ? 1 : 0};\n  pointer-events: ${p => p.$visible ? 'auto' : 'none'};\n  transition: opacity 0.2s;\n\n  &:active {\n    border-style: inset;\n  }\n`;\n\nconst NoMovesOverlay = styled.div<{ $font: string }>`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  padding: 24px 48px;\n  font-family: ${p => p.$font};\n  font-size: 18px;\n  background: rgba(0, 0, 0, 0.85);\n  color: #ffffff;\n  border-radius: 8px;\n  text-align: center;\n  z-index: 100;\n  \n  h2 {\n    margin: 0 0 16px 0;\n    font-size: 24px;\n  }\n  \n  p {\n    margin: 0 0 16px 0;\n    opacity: 0.8;\n  }\n  \n  button {\n    padding: 8px 24px;\n    font-family: inherit;\n    font-size: 14px;\n    background: #c0c0c0;\n    border: 2px outset #ffffff;\n    cursor: pointer;\n    \n    &:active {\n      border-style: inset;\n    }\n  }\n`;\n\nconst TestButton = styled.button<{ $font: string }>`\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  padding: 4px 12px;\n  font-family: ${p => p.$font};\n  font-size: 11px;\n  background: #c0c0c0;\n  border: 2px outset #ffffff;\n  cursor: pointer;\n  opacity: 0.6;\n  z-index: 50;\n  \n  &:hover {\n    opacity: 1;\n  }\n  \n  &:active {\n    border-style: inset;\n  }\n`;\n\n// Default empty options object - stable reference\nconst EMPTY_OPTIONS: SolitaireOptions = {};\nconst EMPTY_SOUND_CONFIG = {};\n\n/**\n * Main Solitaire game component\n */\nexport function Solitaire({\n  theme = defaultTheme,\n  options = EMPTY_OPTIONS,\n  onWin,\n  onNewGame,\n  newGameTrigger,\n  scale = 1,\n  className,\n  showTestButton = false,\n}: SolitaireProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [containerSize, setContainerSize] = useState({ width: 800, height: 600 });\n  const [selectedCard, setSelectedCard] = useState<CardLocation | null>(null);\n  const [showVictory, setShowVictory] = useState(false);\n  const [isAutoCompleting, setIsAutoCompleting] = useState(false);\n  const [launchedCardIds, setLaunchedCardIds] = useState<Set<string>>(new Set());\n  const autoCompleteIntervalRef = useRef<ReturnType<typeof setInterval> | null>(null);\n  \n  // Store callbacks in refs for stable access\n  const onWinRef = useRef(onWin);\n  const onNewGameRef = useRef(onNewGame);\n  onWinRef.current = onWin;\n  onNewGameRef.current = onNewGame;\n\n  // Memoize game config - only changes when specific options change\n  const gameConfig = useMemo<Partial<GameConfig>>(() => ({\n    drawMode: options.drawMode ?? 'draw-one',\n    scoringMode: options.scoringMode ?? 'standard',\n    unlimitedPasses: options.unlimitedPasses ?? true,\n    autoFlipTableau: options.autoFlipTableau ?? false, // Default to click-to-flip like original\n  }), [options.drawMode, options.scoringMode, options.unlimitedPasses, options.autoFlipTableau]);\n\n  // Game state management\n  const {\n    state: gameState,\n    newGame,\n    draw,\n    resetWaste,\n    move,\n    autoMove,\n    flipCard,\n    autoCompleteStep,\n    triggerWin,\n  } = useGame({ config: gameConfig });\n\n  // Store current gameState in ref for use in callbacks\n  const gameStateRef = useRef(gameState);\n  gameStateRef.current = gameState;\n\n  // Store move callback in ref\n  const moveRef = useRef(move);\n  moveRef.current = move;\n\n  // Track game win state\n  const prevIsWonRef = useRef(false);\n  useEffect(() => {\n    if (gameState.isWon && !prevIsWonRef.current) {\n      setShowVictory(true);\n      onWinRef.current?.({\n        time: gameState.endTime && gameState.startTime \n          ? Math.floor((gameState.endTime - gameState.startTime) / 1000) \n          : 0,\n        moves: gameState.moves,\n        score: gameState.score,\n      });\n    }\n    prevIsWonRef.current = gameState.isWon;\n  }, [gameState.isWon, gameState.endTime, gameState.startTime, gameState.moves, gameState.score]);\n\n  // Timer - memoize options object\n  const timerOptions = useMemo(() => ({\n    startTime: gameState.startTime,\n    endTime: gameState.endTime,\n  }), [gameState.startTime, gameState.endTime]);\n  \n  const timer = useTimer(timerOptions);\n\n  // Sounds - use stable config\n  const soundConfig = options.sound ?? EMPTY_SOUND_CONFIG;\n  const sounds = useSounds(soundConfig);\n  \n  // Store sounds ref for use in callbacks\n  const soundsRef = useRef(sounds);\n  soundsRef.current = sounds;\n\n  // Check if move is valid for drag/drop - use ref to get current state\n  const checkValidMove = useCallback((from: CardLocation, to: CardLocation, cardCount: number) => {\n    return isValidMove(gameStateRef.current, from, to, cardCount);\n  }, []);\n\n  // Drag callbacks - stable references using refs\n  const handleDragStart = useCallback(() => {\n    soundsRef.current.play('pickup');\n  }, []);\n\n  const handleDrop = useCallback((from: CardLocation, to: CardLocation, cardCount: number) => {\n    const result = moveRef.current(from, to, cardCount);\n    if (result.success) {\n      soundsRef.current.play('place');\n      setSelectedCard(null);\n    } else {\n      soundsRef.current.play('invalid');\n    }\n  }, []);\n\n  const handleDragEnd = useCallback(() => {\n    // Nothing specific needed\n  }, []);\n\n  // Drag and drop - memoize options\n  const dragOptions = useMemo(() => ({\n    isValidDrop: checkValidMove,\n    onDragStart: handleDragStart,\n    onDrop: handleDrop,\n    onDragEnd: handleDragEnd,\n  }), [checkValidMove, handleDragStart, handleDrop, handleDragEnd]);\n\n  const {\n    dragState,\n    startDrag,\n    currentDropTarget,\n    registerDropTarget,\n    unregisterDropTarget,\n  } = useDrag(dragOptions);\n\n  // Handle new game trigger from parent\n  const prevTriggerRef = useRef(newGameTrigger);\n  useEffect(() => {\n    // Only trigger new game when the value actually changes (not on mount)\n    if (newGameTrigger !== undefined && newGameTrigger !== prevTriggerRef.current) {\n      prevTriggerRef.current = newGameTrigger;\n      newGame();\n      setShowVictory(false);\n      setSelectedCard(null);\n      setIsAutoCompleting(false);\n      setLaunchedCardIds(new Set());\n      onNewGameRef.current?.();\n    }\n  }, [newGameTrigger, newGame]);\n\n  // Measure container\n  useEffect(() => {\n    const updateSize = () => {\n      if (containerRef.current) {\n        setContainerSize({\n          width: containerRef.current.offsetWidth,\n          height: containerRef.current.offsetHeight,\n        });\n      }\n    };\n\n    updateSize();\n    window.addEventListener('resize', updateSize);\n    return () => window.removeEventListener('resize', updateSize);\n  }, []);\n\n  // Auto-complete logic\n  useEffect(() => {\n    if (isAutoCompleting && !gameState.isWon) {\n      autoCompleteIntervalRef.current = setInterval(() => {\n        const moved = autoCompleteStep();\n        if (moved) {\n          soundsRef.current.play('place');\n        } else {\n          setIsAutoCompleting(false);\n        }\n      }, 100);\n    }\n\n    return () => {\n      if (autoCompleteIntervalRef.current) {\n        clearInterval(autoCompleteIntervalRef.current);\n        autoCompleteIntervalRef.current = null;\n      }\n    };\n  }, [isAutoCompleting, gameState.isWon, autoCompleteStep]);\n\n  // Handle stock click - draw or reset\n  const handleStockClick = useCallback(() => {\n    const currentState = gameStateRef.current;\n    if (currentState.stock.cards.length === 0) {\n      if (currentState.waste.cards.length > 0) {\n        resetWaste();\n        soundsRef.current.play('draw');\n      }\n    } else {\n      draw();\n      soundsRef.current.play('draw');\n    }\n  }, [draw, resetWaste]);\n\n  // Handle card click (for click-to-select-then-click-to-move)\n  const handleCardClick = useCallback((location: CardLocation) => {\n    const currentState = gameStateRef.current;\n    const pile = getPile(currentState, location);\n    if (!pile) return;\n\n    const card = pile.cards[location.cardIndex];\n    \n    // Handle clicking on face-down cards in tableau\n    if (!card?.faceUp) {\n      // Only flip if it's the top card of a tableau pile\n      if (pile.type === 'tableau' && location.cardIndex === pile.cards.length - 1) {\n        flipCard(location.pileIndex);\n        soundsRef.current.play('flip');\n      }\n      return;\n    }\n\n    setSelectedCard(prev => {\n      if (prev) {\n        // Try to move selected cards to this location\n        const sourcePile = getPile(currentState, prev);\n        if (!sourcePile) return null;\n\n        const cardCount = sourcePile.cards.length - prev.cardIndex;\n        const destLocation: CardLocation = {\n          ...location,\n          cardIndex: pile.cards.length,\n        };\n\n        const result = moveRef.current(prev, destLocation, cardCount);\n        if (result.success) {\n          soundsRef.current.play('place');\n        }\n        return null;\n      } else {\n        // Select this card\n        if (canPickUpCards(pile, location.cardIndex)) {\n          soundsRef.current.play('flip');\n          return location;\n        }\n        return null;\n      }\n    });\n  }, [flipCard]);\n\n  // Handle card double-click (auto-move to foundation or King to empty)\n  const handleCardDoubleClick = useCallback((location: CardLocation) => {\n    if (options.doubleClickEnabled === false) return;\n\n    // Check if auto-move is possible before attempting\n    const destination = canAutoMove(gameStateRef.current, location);\n    if (destination) {\n      autoMove(location);\n      soundsRef.current.play('place');\n      setSelectedCard(null);\n    }\n  }, [autoMove, options.doubleClickEnabled]);\n\n  // Handle pointer down for drag\n  const handleCardPointerDown = useCallback((\n    event: React.PointerEvent,\n    location: CardLocation,\n    element: HTMLElement\n  ) => {\n    const pile = getPile(gameStateRef.current, location);\n    if (!pile) return;\n\n    const card = pile.cards[location.cardIndex];\n    if (!card?.faceUp) return;\n\n    if (!canPickUpCards(pile, location.cardIndex)) return;\n\n    const cardCount = pile.cards.length - location.cardIndex;\n    startDrag(event, location, cardCount, element);\n  }, [startDrag]);\n\n  // Handle auto-complete button\n  const handleAutoComplete = useCallback(() => {\n    setIsAutoCompleting(true);\n  }, []);\n\n  // Handle test victory button\n  const handleTestVictory = useCallback(() => {\n    triggerWin();\n    setShowVictory(true);\n  }, [triggerWin]);\n\n  // Handle new game from game over screen\n  const handleNewGameFromOverlay = useCallback(() => {\n    newGame();\n    setShowVictory(false);\n    setSelectedCard(null);\n    setIsAutoCompleting(false);\n    setLaunchedCardIds(new Set());\n  }, [newGame]);\n\n  // Handle victory animation complete\n  const handleVictoryComplete = useCallback(() => {\n    // Could show a \"play again\" dialog here\n  }, []);\n\n  // Handle victory bounce sound\n  const handleVictoryBounce = useCallback(() => {\n    soundsRef.current.play('bounce');\n  }, []);\n\n  // Calculate minimum dimensions\n  const cardWidth = theme.card.width * scale;\n  const cardHeight = theme.card.height * scale;\n  const gap = theme.spacing.pileGap * scale;\n  const padding = theme.spacing.tablePadding * scale;\n  \n  const minWidth = (cardWidth * 7) + (gap * 6) + (padding * 2);\n  const minHeight = (cardHeight * 3) + (gap * 2) + (padding * 2) + 40; // +40 for status bar\n\n  // Get cards being dragged\n  const draggedCards = useMemo(() => {\n    if (!dragState.isDragging || !dragState.source) return [];\n    const pile = getPile(gameState, dragState.source);\n    if (!pile) return [];\n    return pile.cards.slice(dragState.source.cardIndex);\n  }, [dragState.isDragging, dragState.source, gameState]);\n\n  // Check if auto-complete is available\n  const canDoAutoComplete = canAutoComplete(gameState) && !isAutoCompleting && !gameState.isWon;\n\n  // Check if there are no valid moves remaining (game over)\n  const isGameOver = !gameState.isWon && !hasValidMoves(gameState);\n\n  // Check if drawing from stock is allowed (for empty stock indicator)\n  // True if there are waste cards to recycle, and unlimited passes is allowed\n  const canDrawFromStock = gameState.waste.cards.length > 0 && \n    (gameState.config.unlimitedPasses || gameState.stockPasses < 3);\n\n  // isValidDropTarget callback for Table - use ref for current drag state\n  const dragStateRef = useRef(dragState);\n  dragStateRef.current = dragState;\n  \n  const isValidDropTarget = useCallback((loc: CardLocation) => {\n    const currentDragState = dragStateRef.current;\n    if (!currentDragState.source) return false;\n    const pile = getPile(gameStateRef.current, currentDragState.source);\n    if (!pile) return false;\n    const cardCount = pile.cards.length - currentDragState.source.cardIndex;\n    return isValidMove(gameStateRef.current, currentDragState.source, loc, cardCount);\n  }, []);\n\n  return (\n    <SolitaireContainer\n      ref={containerRef}\n      $width={minWidth}\n      $height={minHeight}\n      className={className}\n    >\n      <Table\n        gameState={gameState}\n        theme={theme}\n        selectedCard={selectedCard}\n        dropTarget={currentDropTarget?.location}\n        isValidDropTarget={isValidDropTarget}\n        onStockClick={handleStockClick}\n        onCardClick={handleCardClick}\n        onCardDoubleClick={handleCardDoubleClick}\n        onCardPointerDown={handleCardPointerDown}\n        registerDropTarget={registerDropTarget}\n        unregisterDropTarget={unregisterDropTarget}\n        scale={scale}\n        hiddenCardIds={launchedCardIds}\n        canDrawFromStock={canDrawFromStock}\n      />\n\n      {/* Drag layer */}\n      {dragState.isDragging && draggedCards.length > 0 && (\n        <DragLayer>\n          <DraggedCardsContainer\n            $x={dragState.currentX - dragState.offsetX}\n            $y={dragState.currentY - dragState.offsetY}\n          >\n            {draggedCards.map((card, index) => (\n              <div\n                key={card.id}\n                style={{\n                  position: 'absolute',\n                  top: index * theme.spacing.tableauStackedVisible * scale,\n                }}\n              >\n                <Card\n                  card={card}\n                  theme={theme}\n                  scale={scale}\n                  isDragging\n                />\n              </div>\n            ))}\n          </DraggedCardsContainer>\n        </DragLayer>\n      )}\n\n      {/* Auto-complete button */}\n      <AutoCompleteButton\n        $font={theme.typography.uiFont}\n        $visible={canDoAutoComplete}\n        onClick={handleAutoComplete}\n      >\n        Auto Complete\n      </AutoCompleteButton>\n\n      {/* Test victory button (for development) */}\n      {showTestButton && (\n        <TestButton\n          $font={theme.typography.uiFont}\n          onClick={handleTestVictory}\n          title=\"Test victory animation\"\n        >\n           Test Win\n        </TestButton>\n      )}\n\n      {/* Game over overlay - no valid moves remaining */}\n      {isGameOver && (\n        <NoMovesOverlay $font={theme.typography.uiFont}>\n          <h2>No Moves Available</h2>\n          <p>There are no more valid moves in this game.</p>\n          <button onClick={handleNewGameFromOverlay}>New Game</button>\n        </NoMovesOverlay>\n      )}\n\n      {/* Status bar */}\n      <StatusBar\n        $font={theme.typography.uiFont}\n        $fontSize={theme.typography.uiFontSize}\n        $color={theme.colors.text}\n        $bgColor=\"rgba(0, 0, 0, 0.3)\"\n      >\n        <span>Score: {gameState.score}</span>\n        <span>Time: {timer.formatted}</span>\n        <span>Moves: {gameState.moves}</span>\n      </StatusBar>\n\n      {/* Victory animation */}\n      {showVictory && (\n        <VictoryAnimation\n          gameState={gameState}\n          theme={theme}\n          containerWidth={containerSize.width}\n          containerHeight={containerSize.height}\n          scale={scale}\n          onBounce={handleVictoryBounce}\n          onComplete={handleVictoryComplete}\n          onCardsLaunched={setLaunchedCardIds}\n        />\n      )}\n    </SolitaireContainer>\n  );\n}\n\nexport default Solitaire;\n","import styled from 'styled-components';\n\n/**\n * Available card back designs\n */\nexport const CARD_BACKS = [\n  { id: 'Back-Aquarium.gif', name: 'Aquarium' },\n  { id: 'Back-CardHand.gif', name: 'Card Hand' },\n  { id: 'Back-Castle.gif', name: 'Castle' },\n  { id: 'Back-Fishes.gif', name: 'Fishes' },\n  { id: 'Back-FlowerBlack.gif', name: 'Flower (Black)' },\n  { id: 'Back-FlowerBlue.gif', name: 'Flower (Blue)' },\n  { id: 'Back-PalmBeach.gif', name: 'Palm Beach' },\n  { id: 'Back-Pattern1.gif', name: 'Pattern 1' },\n  { id: 'Back-Pattern2.gif', name: 'Pattern 2' },\n  { id: 'Back-Robot.gif', name: 'Robot' },\n  { id: 'Back-Robot-1.gif', name: 'Robot 1' },\n  { id: 'Back-Robot-2.gif', name: 'Robot 2' },\n  { id: 'Back-Robot-3.gif', name: 'Robot 3' },\n  { id: 'Back-Roses.gif', name: 'Roses' },\n  { id: 'Back-Shell.gif', name: 'Shell' },\n] as const;\n\nexport type CardBackId = typeof CARD_BACKS[number]['id'];\n\n/**\n * CardBackSelector component props\n */\nexport interface CardBackSelectorProps {\n  /** Currently selected card back ID */\n  selected: string;\n  /** Callback when selection changes */\n  onSelect: (cardBackId: string) => void;\n  /** Base path to card assets */\n  basePath?: string;\n  /** Additional class name */\n  className?: string;\n}\n\nconst SelectorContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding: 12px;\n  background: #c0c0c0;\n  border: 2px inset #ffffff;\n`;\n\nconst SelectorTitle = styled.div`\n  font-family: 'MS Sans Serif', 'Segoe UI', Tahoma, sans-serif;\n  font-size: 12px;\n  font-weight: bold;\n  margin-bottom: 4px;\n`;\n\nconst CardBackGrid = styled.div`\n  display: grid;\n  grid-template-columns: repeat(5, 1fr);\n  gap: 6px;\n`;\n\nconst CardBackOption = styled.button<{ $isSelected: boolean }>`\n  width: 50px;\n  height: 70px;\n  padding: 2px;\n  border: ${p => p.$isSelected ? '2px solid #000080' : '2px outset #ffffff'};\n  background: ${p => p.$isSelected ? '#000080' : '#c0c0c0'};\n  cursor: pointer;\n  overflow: hidden;\n  \n  &:hover {\n    border-color: #000080;\n  }\n  \n  &:active {\n    border-style: inset;\n  }\n`;\n\nconst CardBackImage = styled.img`\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  /* Pixelated rendering for crisp upscaling */\n  image-rendering: pixelated;\n  image-rendering: -moz-crisp-edges;\n  image-rendering: crisp-edges;\n`;\n\n/**\n * CardBackSelector component\n * Allows users to select from available card back designs\n */\nexport function CardBackSelector({\n  selected,\n  onSelect,\n  basePath = '/cards',\n  className,\n}: CardBackSelectorProps) {\n  return (\n    <SelectorContainer className={className}>\n      <SelectorTitle>Select Card Back</SelectorTitle>\n      <CardBackGrid>\n        {CARD_BACKS.map((cardBack) => (\n          <CardBackOption\n            key={cardBack.id}\n            $isSelected={selected === cardBack.id}\n            onClick={() => onSelect(cardBack.id)}\n            title={cardBack.name}\n          >\n            <CardBackImage\n              src={`${basePath}/${cardBack.id}`}\n              alt={cardBack.name}\n              draggable={false}\n            />\n          </CardBackOption>\n        ))}\n      </CardBackGrid>\n    </SelectorContainer>\n  );\n}\n\nexport default CardBackSelector;\n"]}